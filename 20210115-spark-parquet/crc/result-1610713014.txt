generate --iteration 50 o3fs://bucket1.vol1/testdata
Flokkr launcher script 1.1-18-g58a3efc

===== Plugin is activated ENVTOCONF =====
ozone-site.xml
File ozone-site.xml has been written out successfullly.
hadoop.conf
File hadoop.conf has been written out successfullly.
core-site.xml
File core-site.xml has been written out successfullly.
hdfs-site.xml
File hdfs-site.xml has been written out successfullly.
mapred-site.xml
File mapred-site.xml has been written out successfullly.
Non-spark-on-k8s command provided, proceeding in pass-through mode...
======================================
*** Launching "/opt/testscripts/parquet.sh generate --iteration 50 o3fs://bucket1.vol1/testdata"
+ : /opt/spark
+ : /opt/spark-test/jars/
+ : hcfs-read.btm
+ /opt/spark/bin/spark-submit --conf spark.executor.memory=4g --jars /opt/ozonefs/hadoop-ozone-filesystem.jar /opt/spark-test/jars//spark-samples-1.0-SNAPSHOT.jar generate --iteration 50 o3fs://bucket1.vol1/testdata
21/01/15 12:17:11 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
21/01/15 12:17:11 INFO SparkContext: Running Spark version 3.0.1
21/01/15 12:17:11 INFO ResourceUtils: ==============================================================
21/01/15 12:17:11 INFO ResourceUtils: Resources for spark.driver:

21/01/15 12:17:11 INFO ResourceUtils: ==============================================================
21/01/15 12:17:11 INFO SparkContext: Submitted application: Generate
21/01/15 12:17:11 INFO SecurityManager: Changing view acls to: spark
21/01/15 12:17:11 INFO SecurityManager: Changing modify acls to: spark
21/01/15 12:17:11 INFO SecurityManager: Changing view acls groups to: 
21/01/15 12:17:11 INFO SecurityManager: Changing modify acls groups to: 
21/01/15 12:17:11 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(spark); groups with view permissions: Set(); users  with modify permissions: Set(spark); groups with modify permissions: Set()
21/01/15 12:17:11 INFO Utils: Successfully started service 'sparkDriver' on port 41791.
21/01/15 12:17:11 INFO SparkEnv: Registering MapOutputTracker
21/01/15 12:17:11 INFO SparkEnv: Registering BlockManagerMaster
21/01/15 12:17:12 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
21/01/15 12:17:12 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
21/01/15 12:17:12 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
21/01/15 12:17:12 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-fc632bc9-9968-4af9-a1ae-73ff3b1a5bf5
21/01/15 12:17:12 INFO MemoryStore: MemoryStore started with capacity 413.9 MiB
21/01/15 12:17:12 INFO SparkEnv: Registering OutputCommitCoordinator
21/01/15 12:17:12 INFO Utils: Successfully started service 'SparkUI' on port 4040.
21/01/15 12:17:12 INFO SparkUI: Bound SparkUI to 0.0.0.0, and started at http://test-runner-nc6ld:4040
21/01/15 12:17:12 INFO SparkContext: Added JAR file:///opt/ozonefs/hadoop-ozone-filesystem.jar at spark://test-runner-nc6ld:41791/jars/hadoop-ozone-filesystem.jar with timestamp 1610713032429
21/01/15 12:17:12 INFO SparkContext: Added JAR file:/opt/spark-test/jars/spark-samples-1.0-SNAPSHOT.jar at spark://test-runner-nc6ld:41791/jars/spark-samples-1.0-SNAPSHOT.jar with timestamp 1610713032429
21/01/15 12:17:12 INFO Executor: Starting executor ID driver on host test-runner-nc6ld
21/01/15 12:17:12 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 33443.
21/01/15 12:17:12 INFO NettyBlockTransferService: Server created on test-runner-nc6ld:33443
21/01/15 12:17:12 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
21/01/15 12:17:12 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, test-runner-nc6ld, 33443, None)
21/01/15 12:17:12 INFO BlockManagerMasterEndpoint: Registering block manager test-runner-nc6ld:33443 with 413.9 MiB RAM, BlockManagerId(driver, test-runner-nc6ld, 33443, None)
21/01/15 12:17:12 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, test-runner-nc6ld, 33443, None)
21/01/15 12:17:12 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, test-runner-nc6ld, 33443, None)
21/01/15 12:17:13 INFO SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir ('file:/opt/spark/spark-warehouse').
21/01/15 12:17:13 INFO SharedState: Warehouse path is 'file:/opt/spark/spark-warehouse'.
21/01/15 12:17:16 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:16 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:16 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:16 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:16 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:16 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:16 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:16 INFO CodeGenerator: Code generated in 198.146555 ms
21/01/15 12:17:17 INFO SparkContext: Starting job: parquet at Generate.java:38
21/01/15 12:17:17 INFO DAGScheduler: Got job 0 (parquet at Generate.java:38) with 1 output partitions
21/01/15 12:17:17 INFO DAGScheduler: Final stage: ResultStage 0 (parquet at Generate.java:38)
21/01/15 12:17:17 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:17:17 INFO DAGScheduler: Missing parents: List()
21/01/15 12:17:17 INFO DAGScheduler: Submitting ResultStage 0 (MapPartitionsRDD[1] at parquet at Generate.java:38), which has no missing parents
21/01/15 12:17:17 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:17:17 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:17:17 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:17:17 INFO SparkContext: Created broadcast 0 from broadcast at DAGScheduler.scala:1223
21/01/15 12:17:17 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[1] at parquet at Generate.java:38) (first 15 tasks are for partitions Vector(0))
21/01/15 12:17:17 INFO TaskSchedulerImpl: Adding task set 0.0 with 1 tasks
21/01/15 12:17:17 INFO TaskSetManager: Starting task 0.0 in stage 0.0 (TID 0, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 7541 bytes)
21/01/15 12:17:17 INFO Executor: Running task 0.0 in stage 0.0 (TID 0)
21/01/15 12:17:17 INFO Executor: Fetching spark://test-runner-nc6ld:41791/jars/spark-samples-1.0-SNAPSHOT.jar with timestamp 1610713032429
21/01/15 12:17:17 INFO TransportClientFactory: Successfully created connection to test-runner-nc6ld/10.42.1.8:41791 after 32 ms (0 ms spent in bootstraps)
21/01/15 12:17:17 INFO Utils: Fetching spark://test-runner-nc6ld:41791/jars/spark-samples-1.0-SNAPSHOT.jar to /tmp/spark-c039fb37-0325-4999-9c88-2a838a885c83/userFiles-2b0a15a3-8130-4d43-b293-cd7a8808a989/fetchFileTemp1417882123101695059.tmp
21/01/15 12:17:17 INFO Executor: Adding file:/tmp/spark-c039fb37-0325-4999-9c88-2a838a885c83/userFiles-2b0a15a3-8130-4d43-b293-cd7a8808a989/spark-samples-1.0-SNAPSHOT.jar to class loader
21/01/15 12:17:17 INFO Executor: Fetching spark://test-runner-nc6ld:41791/jars/hadoop-ozone-filesystem.jar with timestamp 1610713032429
21/01/15 12:17:17 INFO Utils: Fetching spark://test-runner-nc6ld:41791/jars/hadoop-ozone-filesystem.jar to /tmp/spark-c039fb37-0325-4999-9c88-2a838a885c83/userFiles-2b0a15a3-8130-4d43-b293-cd7a8808a989/fetchFileTemp4596962711920978082.tmp
21/01/15 12:17:17 INFO Executor: Adding file:/tmp/spark-c039fb37-0325-4999-9c88-2a838a885c83/userFiles-2b0a15a3-8130-4d43-b293-cd7a8808a989/hadoop-ozone-filesystem.jar to class loader
21/01/15 12:17:17 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:17 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:17 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:17 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:17 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:17 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:17 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:17:17 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:17:17 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:17:17 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:17:17 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:17:17 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:17:17 INFO ParquetOutputFormat: Validation is off
21/01/15 12:17:17 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:17:17 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:17:17 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:17:17 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:17:17 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:17:17 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:17:18 WARN MetricsConfig: Cannot locate configuration: tried hadoop-metrics2-xceiverclientmetrics.properties,hadoop-metrics2.properties
21/01/15 12:17:18 INFO MetricsSystemImpl: Scheduled Metric snapshot period at 10 second(s).
21/01/15 12:17:18 INFO MetricsSystemImpl: XceiverClientMetrics metrics system started
21/01/15 12:17:18 INFO CodecPool: Got brand-new compressor [.snappy]
21/01/15 12:17:18 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 17
21/01/15 12:17:18 INFO MetricRegistries: Loaded MetricRegistries class org.apache.ratis.metrics.impl.MetricRegistriesImpl
21/01/15 12:17:18 INFO RatisMetrics: Creating Metrics Registry : ratis.client_message_metrics.client-3D811CFC5F38->b27ffd1c-ee20-4b2d-ad86-0a80e9dc1267
21/01/15 12:17:18 WARN MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReporterRegistration(...) before.
21/01/15 12:17:19 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121717_0000_m_000000_0' to o3fs://bucket1.vol1/testdata
21/01/15 12:17:19 INFO SparkHadoopMapRedUtil: attempt_20210115121717_0000_m_000000_0: Committed
21/01/15 12:17:19 INFO Executor: Finished task 0.0 in stage 0.0 (TID 0). 2198 bytes result sent to driver
21/01/15 12:17:19 INFO TaskSetManager: Finished task 0.0 in stage 0.0 (TID 0) in 2387 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:17:19 INFO TaskSchedulerImpl: Removed TaskSet 0.0, whose tasks have all completed, from pool 
21/01/15 12:17:19 INFO DAGScheduler: ResultStage 0 (parquet at Generate.java:38) finished in 2.599 s
21/01/15 12:17:19 INFO DAGScheduler: Job 0 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:17:19 INFO TaskSchedulerImpl: Killing all running tasks in stage 0: Stage finished
21/01/15 12:17:19 INFO DAGScheduler: Job 0 finished: parquet at Generate.java:38, took 2.645784 s
21/01/15 12:17:19 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-09506f13-44ae-4e25-9cd2-a97967cfdd8c
21/01/15 12:17:19 INFO FileFormatWriter: Write Job 9031ea64-1664-4030-8a37-e498baf2ae0b committed.
21/01/15 12:17:19 INFO FileFormatWriter: Finished processing stats for write job 9031ea64-1664-4030-8a37-e498baf2ae0b.
21/01/15 12:17:21 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:21 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:21 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:21 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:21 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:21 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:21 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:21 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:17:21 INFO DAGScheduler: Got job 1 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:17:21 INFO DAGScheduler: Final stage: ResultStage 1 (parquet at Generate.java:61)
21/01/15 12:17:21 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:17:21 INFO DAGScheduler: Missing parents: List()
21/01/15 12:17:21 INFO DAGScheduler: Submitting ResultStage 1 (MapPartitionsRDD[5] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:17:21 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 205.9 KiB, free 413.5 MiB)
21/01/15 12:17:21 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.4 MiB)
21/01/15 12:17:21 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.8 MiB)
21/01/15 12:17:21 INFO SparkContext: Created broadcast 1 from broadcast at DAGScheduler.scala:1223
21/01/15 12:17:21 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 1 (MapPartitionsRDD[5] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:17:21 INFO TaskSchedulerImpl: Adding task set 1.0 with 1 tasks
21/01/15 12:17:21 WARN TaskSetManager: Stage 1 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:17:21 INFO TaskSetManager: Starting task 0.0 in stage 1.0 (TID 1, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:17:21 INFO Executor: Running task 0.0 in stage 1.0 (TID 1)
21/01/15 12:17:21 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:21 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:21 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:21 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:21 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:21 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:21 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:17:21 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:17:21 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:17:21 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:17:21 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:17:21 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:17:21 INFO ParquetOutputFormat: Validation is off
21/01/15 12:17:21 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:17:21 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:17:21 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:17:21 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:17:21 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:17:21 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:17:21 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:17:22 INFO BlockManagerInfo: Removed broadcast_0_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:17:26 INFO RatisMetrics: Creating Metrics Registry : ratis.client_message_metrics.client-2BB3B9A17ECC->c08b4448-e3e6-4692-885b-be619ea8a953
21/01/15 12:17:26 WARN MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReporterRegistration(...) before.
21/01/15 12:17:26 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121721_0001_m_000000_1' to o3fs://bucket1.vol1/testdata
21/01/15 12:17:26 INFO SparkHadoopMapRedUtil: attempt_20210115121721_0001_m_000000_1: Committed
21/01/15 12:17:26 INFO Executor: Finished task 0.0 in stage 1.0 (TID 1). 2155 bytes result sent to driver
21/01/15 12:17:26 INFO TaskSetManager: Finished task 0.0 in stage 1.0 (TID 1) in 5176 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:17:26 INFO TaskSchedulerImpl: Removed TaskSet 1.0, whose tasks have all completed, from pool 
21/01/15 12:17:26 INFO DAGScheduler: ResultStage 1 (parquet at Generate.java:61) finished in 5.207 s
21/01/15 12:17:26 INFO DAGScheduler: Job 1 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:17:26 INFO TaskSchedulerImpl: Killing all running tasks in stage 1: Stage finished
21/01/15 12:17:26 INFO DAGScheduler: Job 1 finished: parquet at Generate.java:61, took 5.211894 s
21/01/15 12:17:26 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-e3dca2a3-b8d4-4a98-8434-c3997b526502
21/01/15 12:17:26 INFO FileFormatWriter: Write Job 72c40b95-5fa4-4f37-ae74-9136d3cb8a80 committed.
21/01/15 12:17:26 INFO FileFormatWriter: Finished processing stats for write job 72c40b95-5fa4-4f37-ae74-9136d3cb8a80.
21/01/15 12:17:27 INFO BlockManagerInfo: Removed broadcast_1_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:17:28 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:28 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:28 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:28 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:28 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:28 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:28 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:28 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:17:28 INFO DAGScheduler: Got job 2 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:17:28 INFO DAGScheduler: Final stage: ResultStage 2 (parquet at Generate.java:61)
21/01/15 12:17:28 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:17:28 INFO DAGScheduler: Missing parents: List()
21/01/15 12:17:28 INFO DAGScheduler: Submitting ResultStage 2 (MapPartitionsRDD[9] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:17:28 INFO MemoryStore: Block broadcast_2 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:17:28 INFO MemoryStore: Block broadcast_2_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:17:28 INFO BlockManagerInfo: Added broadcast_2_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:17:28 INFO SparkContext: Created broadcast 2 from broadcast at DAGScheduler.scala:1223
21/01/15 12:17:28 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 2 (MapPartitionsRDD[9] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:17:28 INFO TaskSchedulerImpl: Adding task set 2.0 with 1 tasks
21/01/15 12:17:28 WARN TaskSetManager: Stage 2 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:17:28 INFO TaskSetManager: Starting task 0.0 in stage 2.0 (TID 2, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:17:28 INFO Executor: Running task 0.0 in stage 2.0 (TID 2)
21/01/15 12:17:29 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:29 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:29 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:29 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:29 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:29 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:29 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:17:29 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:17:29 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:17:29 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:17:29 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:17:29 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:17:29 INFO ParquetOutputFormat: Validation is off
21/01/15 12:17:29 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:17:29 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:17:29 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:17:29 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:17:29 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:17:29 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:17:29 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:17:30 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121728_0002_m_000000_2' to o3fs://bucket1.vol1/testdata
21/01/15 12:17:30 INFO SparkHadoopMapRedUtil: attempt_20210115121728_0002_m_000000_2: Committed
21/01/15 12:17:30 INFO Executor: Finished task 0.0 in stage 2.0 (TID 2). 2155 bytes result sent to driver
21/01/15 12:17:30 INFO TaskSetManager: Finished task 0.0 in stage 2.0 (TID 2) in 1179 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:17:30 INFO TaskSchedulerImpl: Removed TaskSet 2.0, whose tasks have all completed, from pool 
21/01/15 12:17:30 INFO DAGScheduler: ResultStage 2 (parquet at Generate.java:61) finished in 1.207 s
21/01/15 12:17:30 INFO DAGScheduler: Job 2 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:17:30 INFO TaskSchedulerImpl: Killing all running tasks in stage 2: Stage finished
21/01/15 12:17:30 INFO DAGScheduler: Job 2 finished: parquet at Generate.java:61, took 1.211421 s
21/01/15 12:17:30 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-631b64d8-665f-4ff7-8148-c6fed3ee3361
21/01/15 12:17:30 INFO FileFormatWriter: Write Job 190d97e0-b879-401e-ab09-6efbb1cb6cb2 committed.
21/01/15 12:17:30 INFO FileFormatWriter: Finished processing stats for write job 190d97e0-b879-401e-ab09-6efbb1cb6cb2.
21/01/15 12:17:30 INFO BlockManagerInfo: Removed broadcast_2_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:17:31 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:31 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:31 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:31 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:31 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:31 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:31 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:31 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:17:31 INFO DAGScheduler: Got job 3 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:17:31 INFO DAGScheduler: Final stage: ResultStage 3 (parquet at Generate.java:61)
21/01/15 12:17:31 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:17:31 INFO DAGScheduler: Missing parents: List()
21/01/15 12:17:31 INFO DAGScheduler: Submitting ResultStage 3 (MapPartitionsRDD[13] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:17:32 INFO MemoryStore: Block broadcast_3 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:17:32 INFO MemoryStore: Block broadcast_3_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:17:32 INFO BlockManagerInfo: Added broadcast_3_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:17:32 INFO SparkContext: Created broadcast 3 from broadcast at DAGScheduler.scala:1223
21/01/15 12:17:32 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 3 (MapPartitionsRDD[13] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:17:32 INFO TaskSchedulerImpl: Adding task set 3.0 with 1 tasks
21/01/15 12:17:32 WARN TaskSetManager: Stage 3 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:17:32 INFO TaskSetManager: Starting task 0.0 in stage 3.0 (TID 3, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:17:32 INFO Executor: Running task 0.0 in stage 3.0 (TID 3)
21/01/15 12:17:32 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:32 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:32 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:32 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:32 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:32 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:32 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:17:32 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:17:32 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:17:32 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:17:32 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:17:32 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:17:32 INFO ParquetOutputFormat: Validation is off
21/01/15 12:17:32 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:17:32 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:17:32 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:17:32 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:17:32 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:17:32 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:17:32 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:17:32 INFO RatisMetrics: Creating Metrics Registry : ratis.client_message_metrics.client-8B0AAAAB2CD0->b27ffd1c-ee20-4b2d-ad86-0a80e9dc1267
21/01/15 12:17:32 WARN MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReporterRegistration(...) before.
21/01/15 12:17:33 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121731_0003_m_000000_3' to o3fs://bucket1.vol1/testdata
21/01/15 12:17:33 INFO SparkHadoopMapRedUtil: attempt_20210115121731_0003_m_000000_3: Committed
21/01/15 12:17:33 INFO Executor: Finished task 0.0 in stage 3.0 (TID 3). 2155 bytes result sent to driver
21/01/15 12:17:33 INFO TaskSetManager: Finished task 0.0 in stage 3.0 (TID 3) in 1271 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:17:33 INFO TaskSchedulerImpl: Removed TaskSet 3.0, whose tasks have all completed, from pool 
21/01/15 12:17:33 INFO DAGScheduler: ResultStage 3 (parquet at Generate.java:61) finished in 1.297 s
21/01/15 12:17:33 INFO DAGScheduler: Job 3 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:17:33 INFO TaskSchedulerImpl: Killing all running tasks in stage 3: Stage finished
21/01/15 12:17:33 INFO DAGScheduler: Job 3 finished: parquet at Generate.java:61, took 1.301084 s
21/01/15 12:17:33 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-e05a326c-e90d-4568-8cae-bf83a626cf0f
21/01/15 12:17:33 INFO FileFormatWriter: Write Job 1feb36aa-fa0e-4cae-af4d-7dc0225bae35 committed.
21/01/15 12:17:33 INFO FileFormatWriter: Finished processing stats for write job 1feb36aa-fa0e-4cae-af4d-7dc0225bae35.
21/01/15 12:17:33 INFO BlockManagerInfo: Removed broadcast_3_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:17:35 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:35 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:35 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:35 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:35 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:35 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:35 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:35 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:17:35 INFO DAGScheduler: Got job 4 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:17:35 INFO DAGScheduler: Final stage: ResultStage 4 (parquet at Generate.java:61)
21/01/15 12:17:35 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:17:35 INFO DAGScheduler: Missing parents: List()
21/01/15 12:17:35 INFO DAGScheduler: Submitting ResultStage 4 (MapPartitionsRDD[17] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:17:35 INFO MemoryStore: Block broadcast_4 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:17:35 INFO MemoryStore: Block broadcast_4_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:17:35 INFO BlockManagerInfo: Added broadcast_4_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:17:35 INFO SparkContext: Created broadcast 4 from broadcast at DAGScheduler.scala:1223
21/01/15 12:17:35 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 4 (MapPartitionsRDD[17] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:17:35 INFO TaskSchedulerImpl: Adding task set 4.0 with 1 tasks
21/01/15 12:17:35 WARN TaskSetManager: Stage 4 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:17:35 INFO TaskSetManager: Starting task 0.0 in stage 4.0 (TID 4, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:17:35 INFO Executor: Running task 0.0 in stage 4.0 (TID 4)
21/01/15 12:17:35 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:35 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:35 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:35 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:35 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:35 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:35 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:17:35 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:17:35 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:17:35 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:17:35 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:17:35 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:17:35 INFO ParquetOutputFormat: Validation is off
21/01/15 12:17:35 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:17:35 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:17:35 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:17:35 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:17:35 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:17:35 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:17:35 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:17:36 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121735_0004_m_000000_4' to o3fs://bucket1.vol1/testdata
21/01/15 12:17:36 INFO SparkHadoopMapRedUtil: attempt_20210115121735_0004_m_000000_4: Committed
21/01/15 12:17:36 INFO Executor: Finished task 0.0 in stage 4.0 (TID 4). 2155 bytes result sent to driver
21/01/15 12:17:36 INFO TaskSetManager: Finished task 0.0 in stage 4.0 (TID 4) in 1082 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:17:36 INFO TaskSchedulerImpl: Removed TaskSet 4.0, whose tasks have all completed, from pool 
21/01/15 12:17:36 INFO DAGScheduler: ResultStage 4 (parquet at Generate.java:61) finished in 1.109 s
21/01/15 12:17:36 INFO DAGScheduler: Job 4 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:17:36 INFO TaskSchedulerImpl: Killing all running tasks in stage 4: Stage finished
21/01/15 12:17:36 INFO DAGScheduler: Job 4 finished: parquet at Generate.java:61, took 1.113773 s
21/01/15 12:17:36 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-dbd02530-cff0-40e4-b1ea-f7bc3b968fb2
21/01/15 12:17:36 INFO FileFormatWriter: Write Job c9b4d339-bfa3-4515-bf2a-1a11c06768a5 committed.
21/01/15 12:17:36 INFO FileFormatWriter: Finished processing stats for write job c9b4d339-bfa3-4515-bf2a-1a11c06768a5.
21/01/15 12:17:36 INFO BlockManagerInfo: Removed broadcast_4_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:17:38 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:38 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:38 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:38 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:38 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:38 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:38 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:38 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:17:38 INFO DAGScheduler: Got job 5 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:17:38 INFO DAGScheduler: Final stage: ResultStage 5 (parquet at Generate.java:61)
21/01/15 12:17:38 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:17:38 INFO DAGScheduler: Missing parents: List()
21/01/15 12:17:38 INFO DAGScheduler: Submitting ResultStage 5 (MapPartitionsRDD[21] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:17:38 INFO MemoryStore: Block broadcast_5 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:17:38 INFO MemoryStore: Block broadcast_5_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:17:38 INFO BlockManagerInfo: Added broadcast_5_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:17:38 INFO SparkContext: Created broadcast 5 from broadcast at DAGScheduler.scala:1223
21/01/15 12:17:38 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 5 (MapPartitionsRDD[21] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:17:38 INFO TaskSchedulerImpl: Adding task set 5.0 with 1 tasks
21/01/15 12:17:38 WARN TaskSetManager: Stage 5 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:17:38 INFO TaskSetManager: Starting task 0.0 in stage 5.0 (TID 5, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:17:38 INFO Executor: Running task 0.0 in stage 5.0 (TID 5)
21/01/15 12:17:38 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:38 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:38 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:38 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:38 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:38 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:38 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:17:38 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:17:38 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:17:38 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:17:38 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:17:38 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:17:38 INFO ParquetOutputFormat: Validation is off
21/01/15 12:17:38 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:17:38 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:17:38 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:17:38 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:17:38 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:17:38 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:17:38 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:17:39 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121738_0005_m_000000_5' to o3fs://bucket1.vol1/testdata
21/01/15 12:17:39 INFO SparkHadoopMapRedUtil: attempt_20210115121738_0005_m_000000_5: Committed
21/01/15 12:17:39 INFO Executor: Finished task 0.0 in stage 5.0 (TID 5). 2155 bytes result sent to driver
21/01/15 12:17:39 INFO TaskSetManager: Finished task 0.0 in stage 5.0 (TID 5) in 1153 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:17:39 INFO TaskSchedulerImpl: Removed TaskSet 5.0, whose tasks have all completed, from pool 
21/01/15 12:17:39 INFO DAGScheduler: ResultStage 5 (parquet at Generate.java:61) finished in 1.178 s
21/01/15 12:17:39 INFO DAGScheduler: Job 5 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:17:39 INFO TaskSchedulerImpl: Killing all running tasks in stage 5: Stage finished
21/01/15 12:17:39 INFO DAGScheduler: Job 5 finished: parquet at Generate.java:61, took 1.181795 s
21/01/15 12:17:39 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-fce402e9-f80a-4474-827e-6ab0d08202b2
21/01/15 12:17:39 INFO FileFormatWriter: Write Job 9fad39b9-f5f0-4710-8914-2cbe5f24e867 committed.
21/01/15 12:17:39 INFO FileFormatWriter: Finished processing stats for write job 9fad39b9-f5f0-4710-8914-2cbe5f24e867.
21/01/15 12:17:39 INFO BlockManagerInfo: Removed broadcast_5_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:17:41 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:41 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:41 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:41 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:41 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:41 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:41 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:41 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:17:41 INFO DAGScheduler: Got job 6 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:17:41 INFO DAGScheduler: Final stage: ResultStage 6 (parquet at Generate.java:61)
21/01/15 12:17:41 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:17:41 INFO DAGScheduler: Missing parents: List()
21/01/15 12:17:41 INFO DAGScheduler: Submitting ResultStage 6 (MapPartitionsRDD[25] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:17:41 INFO MemoryStore: Block broadcast_6 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:17:41 INFO MemoryStore: Block broadcast_6_piece0 stored as bytes in memory (estimated size 73.5 KiB, free 413.7 MiB)
21/01/15 12:17:41 INFO BlockManagerInfo: Added broadcast_6_piece0 in memory on test-runner-nc6ld:33443 (size: 73.5 KiB, free: 413.9 MiB)
21/01/15 12:17:41 INFO SparkContext: Created broadcast 6 from broadcast at DAGScheduler.scala:1223
21/01/15 12:17:41 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 6 (MapPartitionsRDD[25] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:17:41 INFO TaskSchedulerImpl: Adding task set 6.0 with 1 tasks
21/01/15 12:17:41 WARN TaskSetManager: Stage 6 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:17:41 INFO TaskSetManager: Starting task 0.0 in stage 6.0 (TID 6, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:17:41 INFO Executor: Running task 0.0 in stage 6.0 (TID 6)
21/01/15 12:17:41 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:41 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:41 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:41 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:41 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:41 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:41 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:17:41 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:17:41 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:17:41 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:17:41 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:17:41 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:17:41 INFO ParquetOutputFormat: Validation is off
21/01/15 12:17:41 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:17:41 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:17:41 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:17:41 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:17:41 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:17:41 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:17:41 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:17:42 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121741_0006_m_000000_6' to o3fs://bucket1.vol1/testdata
21/01/15 12:17:42 INFO SparkHadoopMapRedUtil: attempt_20210115121741_0006_m_000000_6: Committed
21/01/15 12:17:42 INFO Executor: Finished task 0.0 in stage 6.0 (TID 6). 2155 bytes result sent to driver
21/01/15 12:17:42 INFO TaskSetManager: Finished task 0.0 in stage 6.0 (TID 6) in 933 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:17:42 INFO TaskSchedulerImpl: Removed TaskSet 6.0, whose tasks have all completed, from pool 
21/01/15 12:17:42 INFO DAGScheduler: ResultStage 6 (parquet at Generate.java:61) finished in 0.959 s
21/01/15 12:17:42 INFO DAGScheduler: Job 6 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:17:42 INFO TaskSchedulerImpl: Killing all running tasks in stage 6: Stage finished
21/01/15 12:17:42 INFO DAGScheduler: Job 6 finished: parquet at Generate.java:61, took 0.963681 s
21/01/15 12:17:42 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-a23f094f-f383-450b-a0a0-e79212e43e59
21/01/15 12:17:42 INFO FileFormatWriter: Write Job df2ac8ba-7026-4c69-a1ed-46e0d3e46ac7 committed.
21/01/15 12:17:42 INFO FileFormatWriter: Finished processing stats for write job df2ac8ba-7026-4c69-a1ed-46e0d3e46ac7.
21/01/15 12:17:42 INFO BlockManagerInfo: Removed broadcast_6_piece0 on test-runner-nc6ld:33443 in memory (size: 73.5 KiB, free: 413.9 MiB)
21/01/15 12:17:44 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:44 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:44 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:44 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:44 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:44 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:44 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:44 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:17:44 INFO DAGScheduler: Got job 7 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:17:44 INFO DAGScheduler: Final stage: ResultStage 7 (parquet at Generate.java:61)
21/01/15 12:17:44 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:17:44 INFO DAGScheduler: Missing parents: List()
21/01/15 12:17:44 INFO DAGScheduler: Submitting ResultStage 7 (MapPartitionsRDD[29] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:17:44 INFO MemoryStore: Block broadcast_7 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:17:44 INFO MemoryStore: Block broadcast_7_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:17:44 INFO BlockManagerInfo: Added broadcast_7_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:17:44 INFO SparkContext: Created broadcast 7 from broadcast at DAGScheduler.scala:1223
21/01/15 12:17:44 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 7 (MapPartitionsRDD[29] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:17:44 INFO TaskSchedulerImpl: Adding task set 7.0 with 1 tasks
21/01/15 12:17:44 WARN TaskSetManager: Stage 7 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:17:44 INFO TaskSetManager: Starting task 0.0 in stage 7.0 (TID 7, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:17:44 INFO Executor: Running task 0.0 in stage 7.0 (TID 7)
21/01/15 12:17:44 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:44 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:44 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:44 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:44 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:44 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:44 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:17:44 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:17:44 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:17:44 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:17:44 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:17:44 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:17:44 INFO ParquetOutputFormat: Validation is off
21/01/15 12:17:44 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:17:44 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:17:44 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:17:44 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:17:44 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:17:44 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:17:44 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:17:45 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121744_0007_m_000000_7' to o3fs://bucket1.vol1/testdata
21/01/15 12:17:45 INFO SparkHadoopMapRedUtil: attempt_20210115121744_0007_m_000000_7: Committed
21/01/15 12:17:45 INFO Executor: Finished task 0.0 in stage 7.0 (TID 7). 2155 bytes result sent to driver
21/01/15 12:17:45 INFO TaskSetManager: Finished task 0.0 in stage 7.0 (TID 7) in 1035 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:17:45 INFO TaskSchedulerImpl: Removed TaskSet 7.0, whose tasks have all completed, from pool 
21/01/15 12:17:45 INFO DAGScheduler: ResultStage 7 (parquet at Generate.java:61) finished in 1.059 s
21/01/15 12:17:45 INFO DAGScheduler: Job 7 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:17:45 INFO TaskSchedulerImpl: Killing all running tasks in stage 7: Stage finished
21/01/15 12:17:45 INFO DAGScheduler: Job 7 finished: parquet at Generate.java:61, took 1.062438 s
21/01/15 12:17:45 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-7b9d23c0-b53d-4ad7-8e02-bd7f0dad3176
21/01/15 12:17:45 INFO FileFormatWriter: Write Job 721e4621-3b96-4f18-be6e-61ba35405c18 committed.
21/01/15 12:17:45 INFO FileFormatWriter: Finished processing stats for write job 721e4621-3b96-4f18-be6e-61ba35405c18.
21/01/15 12:17:45 INFO BlockManagerInfo: Removed broadcast_7_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:17:47 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:47 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:47 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:47 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:47 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:47 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:47 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:47 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:17:47 INFO DAGScheduler: Got job 8 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:17:47 INFO DAGScheduler: Final stage: ResultStage 8 (parquet at Generate.java:61)
21/01/15 12:17:47 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:17:47 INFO DAGScheduler: Missing parents: List()
21/01/15 12:17:47 INFO DAGScheduler: Submitting ResultStage 8 (MapPartitionsRDD[33] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:17:47 INFO MemoryStore: Block broadcast_8 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:17:47 INFO MemoryStore: Block broadcast_8_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:17:47 INFO BlockManagerInfo: Added broadcast_8_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:17:47 INFO SparkContext: Created broadcast 8 from broadcast at DAGScheduler.scala:1223
21/01/15 12:17:47 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 8 (MapPartitionsRDD[33] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:17:47 INFO TaskSchedulerImpl: Adding task set 8.0 with 1 tasks
21/01/15 12:17:47 WARN TaskSetManager: Stage 8 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:17:47 INFO TaskSetManager: Starting task 0.0 in stage 8.0 (TID 8, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:17:47 INFO Executor: Running task 0.0 in stage 8.0 (TID 8)
21/01/15 12:17:47 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:47 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:47 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:47 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:47 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:47 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:47 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:17:47 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:17:47 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:17:47 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:17:47 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:17:47 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:17:47 INFO ParquetOutputFormat: Validation is off
21/01/15 12:17:47 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:17:47 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:17:47 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:17:47 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:17:47 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:17:47 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:17:47 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:17:48 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121747_0008_m_000000_8' to o3fs://bucket1.vol1/testdata
21/01/15 12:17:48 INFO SparkHadoopMapRedUtil: attempt_20210115121747_0008_m_000000_8: Committed
21/01/15 12:17:48 INFO Executor: Finished task 0.0 in stage 8.0 (TID 8). 2155 bytes result sent to driver
21/01/15 12:17:48 INFO TaskSetManager: Finished task 0.0 in stage 8.0 (TID 8) in 1098 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:17:48 INFO TaskSchedulerImpl: Removed TaskSet 8.0, whose tasks have all completed, from pool 
21/01/15 12:17:48 INFO DAGScheduler: ResultStage 8 (parquet at Generate.java:61) finished in 1.123 s
21/01/15 12:17:48 INFO DAGScheduler: Job 8 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:17:48 INFO TaskSchedulerImpl: Killing all running tasks in stage 8: Stage finished
21/01/15 12:17:48 INFO DAGScheduler: Job 8 finished: parquet at Generate.java:61, took 1.126583 s
21/01/15 12:17:48 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-d51f02f3-1a5a-44ed-8125-2cc8685719a0
21/01/15 12:17:48 INFO FileFormatWriter: Write Job 2a962a11-8ce9-41ea-b2e0-6a62bc83133d committed.
21/01/15 12:17:48 INFO FileFormatWriter: Finished processing stats for write job 2a962a11-8ce9-41ea-b2e0-6a62bc83133d.
21/01/15 12:17:48 INFO BlockManagerInfo: Removed broadcast_8_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:17:50 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:50 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:50 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:50 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:50 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:50 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:50 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:50 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:17:50 INFO DAGScheduler: Got job 9 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:17:50 INFO DAGScheduler: Final stage: ResultStage 9 (parquet at Generate.java:61)
21/01/15 12:17:50 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:17:50 INFO DAGScheduler: Missing parents: List()
21/01/15 12:17:50 INFO DAGScheduler: Submitting ResultStage 9 (MapPartitionsRDD[37] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:17:50 INFO MemoryStore: Block broadcast_9 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:17:50 INFO MemoryStore: Block broadcast_9_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:17:50 INFO BlockManagerInfo: Added broadcast_9_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:17:50 INFO SparkContext: Created broadcast 9 from broadcast at DAGScheduler.scala:1223
21/01/15 12:17:50 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 9 (MapPartitionsRDD[37] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:17:50 INFO TaskSchedulerImpl: Adding task set 9.0 with 1 tasks
21/01/15 12:17:50 WARN TaskSetManager: Stage 9 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:17:50 INFO TaskSetManager: Starting task 0.0 in stage 9.0 (TID 9, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:17:50 INFO Executor: Running task 0.0 in stage 9.0 (TID 9)
21/01/15 12:17:50 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:50 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:50 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:50 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:50 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:50 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:50 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:17:50 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:17:50 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:17:50 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:17:50 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:17:50 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:17:50 INFO ParquetOutputFormat: Validation is off
21/01/15 12:17:50 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:17:50 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:17:50 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:17:50 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:17:50 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:17:50 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:17:50 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:17:50 INFO RatisMetrics: Creating Metrics Registry : ratis.client_message_metrics.client-F8294AD402FF->c08b4448-e3e6-4692-885b-be619ea8a953
21/01/15 12:17:50 WARN MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReporterRegistration(...) before.
21/01/15 12:17:51 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121750_0009_m_000000_9' to o3fs://bucket1.vol1/testdata
21/01/15 12:17:51 INFO SparkHadoopMapRedUtil: attempt_20210115121750_0009_m_000000_9: Committed
21/01/15 12:17:51 INFO Executor: Finished task 0.0 in stage 9.0 (TID 9). 2155 bytes result sent to driver
21/01/15 12:17:51 INFO TaskSetManager: Finished task 0.0 in stage 9.0 (TID 9) in 1037 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:17:51 INFO TaskSchedulerImpl: Removed TaskSet 9.0, whose tasks have all completed, from pool 
21/01/15 12:17:51 INFO DAGScheduler: ResultStage 9 (parquet at Generate.java:61) finished in 1.063 s
21/01/15 12:17:51 INFO DAGScheduler: Job 9 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:17:51 INFO TaskSchedulerImpl: Killing all running tasks in stage 9: Stage finished
21/01/15 12:17:51 INFO DAGScheduler: Job 9 finished: parquet at Generate.java:61, took 1.065991 s
21/01/15 12:17:51 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-d8e753b2-9404-44c6-a387-18b347458bef
21/01/15 12:17:51 INFO FileFormatWriter: Write Job c68fbc54-5491-4216-a006-ebb37aad3c88 committed.
21/01/15 12:17:51 INFO FileFormatWriter: Finished processing stats for write job c68fbc54-5491-4216-a006-ebb37aad3c88.
21/01/15 12:17:51 INFO BlockManagerInfo: Removed broadcast_9_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:17:53 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:53 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:53 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:53 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:53 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:53 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:53 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:53 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:17:53 INFO DAGScheduler: Got job 10 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:17:53 INFO DAGScheduler: Final stage: ResultStage 10 (parquet at Generate.java:61)
21/01/15 12:17:53 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:17:53 INFO DAGScheduler: Missing parents: List()
21/01/15 12:17:53 INFO DAGScheduler: Submitting ResultStage 10 (MapPartitionsRDD[41] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:17:53 INFO MemoryStore: Block broadcast_10 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:17:53 INFO MemoryStore: Block broadcast_10_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:17:53 INFO BlockManagerInfo: Added broadcast_10_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:17:53 INFO SparkContext: Created broadcast 10 from broadcast at DAGScheduler.scala:1223
21/01/15 12:17:53 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 10 (MapPartitionsRDD[41] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:17:53 INFO TaskSchedulerImpl: Adding task set 10.0 with 1 tasks
21/01/15 12:17:53 WARN TaskSetManager: Stage 10 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:17:53 INFO TaskSetManager: Starting task 0.0 in stage 10.0 (TID 10, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:17:53 INFO Executor: Running task 0.0 in stage 10.0 (TID 10)
21/01/15 12:17:53 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:53 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:53 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:53 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:53 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:53 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:53 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:17:53 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:17:53 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:17:53 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:17:53 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:17:53 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:17:53 INFO ParquetOutputFormat: Validation is off
21/01/15 12:17:53 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:17:53 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:17:53 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:17:53 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:17:53 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:17:53 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:17:53 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:17:54 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121753_0010_m_000000_10' to o3fs://bucket1.vol1/testdata
21/01/15 12:17:54 INFO SparkHadoopMapRedUtil: attempt_20210115121753_0010_m_000000_10: Committed
21/01/15 12:17:54 INFO Executor: Finished task 0.0 in stage 10.0 (TID 10). 2155 bytes result sent to driver
21/01/15 12:17:54 INFO TaskSetManager: Finished task 0.0 in stage 10.0 (TID 10) in 1010 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:17:54 INFO TaskSchedulerImpl: Removed TaskSet 10.0, whose tasks have all completed, from pool 
21/01/15 12:17:54 INFO DAGScheduler: ResultStage 10 (parquet at Generate.java:61) finished in 1.035 s
21/01/15 12:17:54 INFO DAGScheduler: Job 10 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:17:54 INFO TaskSchedulerImpl: Killing all running tasks in stage 10: Stage finished
21/01/15 12:17:54 INFO DAGScheduler: Job 10 finished: parquet at Generate.java:61, took 1.037254 s
21/01/15 12:17:54 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-1d439dbf-8a96-43e6-9ced-10f58dcd9124
21/01/15 12:17:54 INFO FileFormatWriter: Write Job d2008ec5-c07a-4612-97cd-7e16e05a6993 committed.
21/01/15 12:17:54 INFO FileFormatWriter: Finished processing stats for write job d2008ec5-c07a-4612-97cd-7e16e05a6993.
21/01/15 12:17:54 INFO BlockManagerInfo: Removed broadcast_10_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:17:55 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:55 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:55 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:55 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:55 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:55 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:55 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:56 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:17:56 INFO DAGScheduler: Got job 11 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:17:56 INFO DAGScheduler: Final stage: ResultStage 11 (parquet at Generate.java:61)
21/01/15 12:17:56 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:17:56 INFO DAGScheduler: Missing parents: List()
21/01/15 12:17:56 INFO DAGScheduler: Submitting ResultStage 11 (MapPartitionsRDD[45] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:17:56 INFO MemoryStore: Block broadcast_11 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:17:56 INFO MemoryStore: Block broadcast_11_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:17:56 INFO BlockManagerInfo: Added broadcast_11_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:17:56 INFO SparkContext: Created broadcast 11 from broadcast at DAGScheduler.scala:1223
21/01/15 12:17:56 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 11 (MapPartitionsRDD[45] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:17:56 INFO TaskSchedulerImpl: Adding task set 11.0 with 1 tasks
21/01/15 12:17:56 WARN TaskSetManager: Stage 11 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:17:56 INFO TaskSetManager: Starting task 0.0 in stage 11.0 (TID 11, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:17:56 INFO Executor: Running task 0.0 in stage 11.0 (TID 11)
21/01/15 12:17:56 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:56 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:56 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:56 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:56 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:56 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:56 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:17:56 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:17:56 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:17:56 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:17:56 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:17:56 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:17:56 INFO ParquetOutputFormat: Validation is off
21/01/15 12:17:56 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:17:56 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:17:56 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:17:56 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:17:56 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:17:56 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:17:56 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:17:57 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121755_0011_m_000000_11' to o3fs://bucket1.vol1/testdata
21/01/15 12:17:57 INFO SparkHadoopMapRedUtil: attempt_20210115121755_0011_m_000000_11: Committed
21/01/15 12:17:57 INFO Executor: Finished task 0.0 in stage 11.0 (TID 11). 2155 bytes result sent to driver
21/01/15 12:17:57 INFO TaskSetManager: Finished task 0.0 in stage 11.0 (TID 11) in 1011 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:17:57 INFO TaskSchedulerImpl: Removed TaskSet 11.0, whose tasks have all completed, from pool 
21/01/15 12:17:57 INFO DAGScheduler: ResultStage 11 (parquet at Generate.java:61) finished in 1.034 s
21/01/15 12:17:57 INFO DAGScheduler: Job 11 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:17:57 INFO TaskSchedulerImpl: Killing all running tasks in stage 11: Stage finished
21/01/15 12:17:57 INFO DAGScheduler: Job 11 finished: parquet at Generate.java:61, took 1.037831 s
21/01/15 12:17:57 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-ea2c32fb-f3d3-4bbe-a937-f7d2a6b7021f
21/01/15 12:17:57 INFO FileFormatWriter: Write Job c7d33ce5-6ff9-4b50-9cc7-96e80fa0551d committed.
21/01/15 12:17:57 INFO FileFormatWriter: Finished processing stats for write job c7d33ce5-6ff9-4b50-9cc7-96e80fa0551d.
21/01/15 12:17:57 INFO BlockManagerInfo: Removed broadcast_11_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:17:58 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:58 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:58 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:58 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:58 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:58 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:58 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:58 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:17:58 INFO DAGScheduler: Got job 12 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:17:58 INFO DAGScheduler: Final stage: ResultStage 12 (parquet at Generate.java:61)
21/01/15 12:17:58 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:17:58 INFO DAGScheduler: Missing parents: List()
21/01/15 12:17:58 INFO DAGScheduler: Submitting ResultStage 12 (MapPartitionsRDD[49] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:17:58 INFO MemoryStore: Block broadcast_12 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:17:58 INFO MemoryStore: Block broadcast_12_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:17:58 INFO BlockManagerInfo: Added broadcast_12_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:17:58 INFO SparkContext: Created broadcast 12 from broadcast at DAGScheduler.scala:1223
21/01/15 12:17:58 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 12 (MapPartitionsRDD[49] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:17:58 INFO TaskSchedulerImpl: Adding task set 12.0 with 1 tasks
21/01/15 12:17:59 WARN TaskSetManager: Stage 12 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:17:59 INFO TaskSetManager: Starting task 0.0 in stage 12.0 (TID 12, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:17:59 INFO Executor: Running task 0.0 in stage 12.0 (TID 12)
21/01/15 12:17:59 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:59 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:59 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:59 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:17:59 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:17:59 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:17:59 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:17:59 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:17:59 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:17:59 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:17:59 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:17:59 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:17:59 INFO ParquetOutputFormat: Validation is off
21/01/15 12:17:59 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:17:59 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:17:59 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:17:59 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:17:59 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:17:59 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:17:59 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:18:00 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121758_0012_m_000000_12' to o3fs://bucket1.vol1/testdata
21/01/15 12:18:00 INFO SparkHadoopMapRedUtil: attempt_20210115121758_0012_m_000000_12: Committed
21/01/15 12:18:00 INFO Executor: Finished task 0.0 in stage 12.0 (TID 12). 2155 bytes result sent to driver
21/01/15 12:18:00 INFO TaskSetManager: Finished task 0.0 in stage 12.0 (TID 12) in 1080 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:18:00 INFO TaskSchedulerImpl: Removed TaskSet 12.0, whose tasks have all completed, from pool 
21/01/15 12:18:00 INFO DAGScheduler: ResultStage 12 (parquet at Generate.java:61) finished in 1.105 s
21/01/15 12:18:00 INFO DAGScheduler: Job 12 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:18:00 INFO TaskSchedulerImpl: Killing all running tasks in stage 12: Stage finished
21/01/15 12:18:00 INFO DAGScheduler: Job 12 finished: parquet at Generate.java:61, took 1.107776 s
21/01/15 12:18:00 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-439b6b36-6876-47bb-b9ae-831309b544d1
21/01/15 12:18:00 INFO FileFormatWriter: Write Job 8bebcbaa-23c9-4e05-9384-b7b80890190b committed.
21/01/15 12:18:00 INFO FileFormatWriter: Finished processing stats for write job 8bebcbaa-23c9-4e05-9384-b7b80890190b.
21/01/15 12:18:00 INFO BlockManagerInfo: Removed broadcast_12_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:18:01 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:01 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:01 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:01 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:01 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:01 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:01 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:01 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:18:01 INFO DAGScheduler: Got job 13 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:18:01 INFO DAGScheduler: Final stage: ResultStage 13 (parquet at Generate.java:61)
21/01/15 12:18:01 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:18:01 INFO DAGScheduler: Missing parents: List()
21/01/15 12:18:01 INFO DAGScheduler: Submitting ResultStage 13 (MapPartitionsRDD[53] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:18:01 INFO MemoryStore: Block broadcast_13 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:18:01 INFO MemoryStore: Block broadcast_13_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:18:01 INFO BlockManagerInfo: Added broadcast_13_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:18:01 INFO SparkContext: Created broadcast 13 from broadcast at DAGScheduler.scala:1223
21/01/15 12:18:01 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 13 (MapPartitionsRDD[53] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:18:01 INFO TaskSchedulerImpl: Adding task set 13.0 with 1 tasks
21/01/15 12:18:02 WARN TaskSetManager: Stage 13 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:18:02 INFO TaskSetManager: Starting task 0.0 in stage 13.0 (TID 13, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:18:02 INFO Executor: Running task 0.0 in stage 13.0 (TID 13)
21/01/15 12:18:02 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:02 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:02 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:02 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:02 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:02 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:02 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:18:02 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:18:02 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:18:02 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:18:02 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:18:02 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:18:02 INFO ParquetOutputFormat: Validation is off
21/01/15 12:18:02 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:18:02 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:18:02 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:18:02 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:18:02 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:18:02 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:18:02 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:18:02 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121801_0013_m_000000_13' to o3fs://bucket1.vol1/testdata
21/01/15 12:18:02 INFO SparkHadoopMapRedUtil: attempt_20210115121801_0013_m_000000_13: Committed
21/01/15 12:18:02 INFO Executor: Finished task 0.0 in stage 13.0 (TID 13). 2155 bytes result sent to driver
21/01/15 12:18:02 INFO TaskSetManager: Finished task 0.0 in stage 13.0 (TID 13) in 1014 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:18:02 INFO TaskSchedulerImpl: Removed TaskSet 13.0, whose tasks have all completed, from pool 
21/01/15 12:18:02 INFO DAGScheduler: ResultStage 13 (parquet at Generate.java:61) finished in 1.037 s
21/01/15 12:18:02 INFO DAGScheduler: Job 13 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:18:02 INFO TaskSchedulerImpl: Killing all running tasks in stage 13: Stage finished
21/01/15 12:18:02 INFO DAGScheduler: Job 13 finished: parquet at Generate.java:61, took 1.039646 s
21/01/15 12:18:02 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-f208eca1-e2ed-4f74-b631-82f2c8b41f7d
21/01/15 12:18:02 INFO FileFormatWriter: Write Job 53653e5a-1631-47c6-b86b-76124dfd2be7 committed.
21/01/15 12:18:02 INFO FileFormatWriter: Finished processing stats for write job 53653e5a-1631-47c6-b86b-76124dfd2be7.
21/01/15 12:18:03 INFO BlockManagerInfo: Removed broadcast_13_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:18:04 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:04 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:04 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:04 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:04 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:04 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:04 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:04 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:18:04 INFO DAGScheduler: Got job 14 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:18:04 INFO DAGScheduler: Final stage: ResultStage 14 (parquet at Generate.java:61)
21/01/15 12:18:04 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:18:04 INFO DAGScheduler: Missing parents: List()
21/01/15 12:18:04 INFO DAGScheduler: Submitting ResultStage 14 (MapPartitionsRDD[57] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:18:04 INFO MemoryStore: Block broadcast_14 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:18:04 INFO MemoryStore: Block broadcast_14_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:18:04 INFO BlockManagerInfo: Added broadcast_14_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:18:04 INFO SparkContext: Created broadcast 14 from broadcast at DAGScheduler.scala:1223
21/01/15 12:18:04 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 14 (MapPartitionsRDD[57] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:18:04 INFO TaskSchedulerImpl: Adding task set 14.0 with 1 tasks
21/01/15 12:18:04 WARN TaskSetManager: Stage 14 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:18:04 INFO TaskSetManager: Starting task 0.0 in stage 14.0 (TID 14, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:18:04 INFO Executor: Running task 0.0 in stage 14.0 (TID 14)
21/01/15 12:18:05 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:05 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:05 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:05 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:05 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:05 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:05 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:18:05 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:18:05 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:18:05 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:18:05 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:18:05 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:18:05 INFO ParquetOutputFormat: Validation is off
21/01/15 12:18:05 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:18:05 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:18:05 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:18:05 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:18:05 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:18:05 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:18:05 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:18:05 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121804_0014_m_000000_14' to o3fs://bucket1.vol1/testdata
21/01/15 12:18:05 INFO SparkHadoopMapRedUtil: attempt_20210115121804_0014_m_000000_14: Committed
21/01/15 12:18:05 INFO Executor: Finished task 0.0 in stage 14.0 (TID 14). 2155 bytes result sent to driver
21/01/15 12:18:05 INFO TaskSetManager: Finished task 0.0 in stage 14.0 (TID 14) in 998 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:18:05 INFO TaskSchedulerImpl: Removed TaskSet 14.0, whose tasks have all completed, from pool 
21/01/15 12:18:05 INFO DAGScheduler: ResultStage 14 (parquet at Generate.java:61) finished in 1.020 s
21/01/15 12:18:05 INFO DAGScheduler: Job 14 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:18:05 INFO TaskSchedulerImpl: Killing all running tasks in stage 14: Stage finished
21/01/15 12:18:05 INFO DAGScheduler: Job 14 finished: parquet at Generate.java:61, took 1.022730 s
21/01/15 12:18:05 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-249ff500-5e2e-4f0d-b3ec-e6b6939aa18d
21/01/15 12:18:05 INFO FileFormatWriter: Write Job 29b06566-5a02-4206-81c2-85a18065c18f committed.
21/01/15 12:18:05 INFO FileFormatWriter: Finished processing stats for write job 29b06566-5a02-4206-81c2-85a18065c18f.
21/01/15 12:18:06 INFO BlockManagerInfo: Removed broadcast_14_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:18:07 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:07 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:07 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:07 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:07 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:07 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:07 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:07 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:18:07 INFO DAGScheduler: Got job 15 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:18:07 INFO DAGScheduler: Final stage: ResultStage 15 (parquet at Generate.java:61)
21/01/15 12:18:07 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:18:07 INFO DAGScheduler: Missing parents: List()
21/01/15 12:18:07 INFO DAGScheduler: Submitting ResultStage 15 (MapPartitionsRDD[61] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:18:07 INFO MemoryStore: Block broadcast_15 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:18:07 INFO MemoryStore: Block broadcast_15_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:18:07 INFO BlockManagerInfo: Added broadcast_15_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:18:07 INFO SparkContext: Created broadcast 15 from broadcast at DAGScheduler.scala:1223
21/01/15 12:18:07 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 15 (MapPartitionsRDD[61] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:18:07 INFO TaskSchedulerImpl: Adding task set 15.0 with 1 tasks
21/01/15 12:18:07 WARN TaskSetManager: Stage 15 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:18:07 INFO TaskSetManager: Starting task 0.0 in stage 15.0 (TID 15, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:18:07 INFO Executor: Running task 0.0 in stage 15.0 (TID 15)
21/01/15 12:18:07 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:07 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:07 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:07 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:07 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:07 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:07 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:18:07 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:18:07 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:18:07 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:18:07 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:18:07 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:18:07 INFO ParquetOutputFormat: Validation is off
21/01/15 12:18:07 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:18:07 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:18:07 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:18:07 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:18:07 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:18:07 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:18:08 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:18:08 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121807_0015_m_000000_15' to o3fs://bucket1.vol1/testdata
21/01/15 12:18:08 INFO SparkHadoopMapRedUtil: attempt_20210115121807_0015_m_000000_15: Committed
21/01/15 12:18:08 INFO Executor: Finished task 0.0 in stage 15.0 (TID 15). 2155 bytes result sent to driver
21/01/15 12:18:08 INFO TaskSetManager: Finished task 0.0 in stage 15.0 (TID 15) in 1039 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:18:08 INFO TaskSchedulerImpl: Removed TaskSet 15.0, whose tasks have all completed, from pool 
21/01/15 12:18:08 INFO DAGScheduler: ResultStage 15 (parquet at Generate.java:61) finished in 1.060 s
21/01/15 12:18:08 INFO DAGScheduler: Job 15 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:18:08 INFO TaskSchedulerImpl: Killing all running tasks in stage 15: Stage finished
21/01/15 12:18:08 INFO DAGScheduler: Job 15 finished: parquet at Generate.java:61, took 1.063428 s
21/01/15 12:18:08 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-d7adabcb-410c-494f-8ec3-a8a4a0076b6b
21/01/15 12:18:08 INFO FileFormatWriter: Write Job 35b2b646-952d-4be2-94a6-cfa60f6c4173 committed.
21/01/15 12:18:08 INFO FileFormatWriter: Finished processing stats for write job 35b2b646-952d-4be2-94a6-cfa60f6c4173.
21/01/15 12:18:09 INFO BlockManagerInfo: Removed broadcast_15_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:18:10 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:10 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:10 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:10 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:10 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:10 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:10 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:10 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:18:10 INFO DAGScheduler: Got job 16 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:18:10 INFO DAGScheduler: Final stage: ResultStage 16 (parquet at Generate.java:61)
21/01/15 12:18:10 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:18:10 INFO DAGScheduler: Missing parents: List()
21/01/15 12:18:10 INFO DAGScheduler: Submitting ResultStage 16 (MapPartitionsRDD[65] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:18:10 INFO MemoryStore: Block broadcast_16 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:18:10 INFO MemoryStore: Block broadcast_16_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:18:10 INFO BlockManagerInfo: Added broadcast_16_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:18:10 INFO SparkContext: Created broadcast 16 from broadcast at DAGScheduler.scala:1223
21/01/15 12:18:10 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 16 (MapPartitionsRDD[65] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:18:10 INFO TaskSchedulerImpl: Adding task set 16.0 with 1 tasks
21/01/15 12:18:10 WARN TaskSetManager: Stage 16 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:18:10 INFO TaskSetManager: Starting task 0.0 in stage 16.0 (TID 16, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:18:10 INFO Executor: Running task 0.0 in stage 16.0 (TID 16)
21/01/15 12:18:10 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:10 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:10 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:10 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:10 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:10 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:10 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:18:10 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:18:10 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:18:10 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:18:10 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:18:10 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:18:10 INFO ParquetOutputFormat: Validation is off
21/01/15 12:18:10 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:18:10 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:18:10 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:18:10 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:18:10 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:18:10 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:18:10 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:18:11 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121810_0016_m_000000_16' to o3fs://bucket1.vol1/testdata
21/01/15 12:18:11 INFO SparkHadoopMapRedUtil: attempt_20210115121810_0016_m_000000_16: Committed
21/01/15 12:18:11 INFO Executor: Finished task 0.0 in stage 16.0 (TID 16). 2155 bytes result sent to driver
21/01/15 12:18:11 INFO TaskSetManager: Finished task 0.0 in stage 16.0 (TID 16) in 1074 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:18:11 INFO TaskSchedulerImpl: Removed TaskSet 16.0, whose tasks have all completed, from pool 
21/01/15 12:18:11 INFO DAGScheduler: ResultStage 16 (parquet at Generate.java:61) finished in 1.095 s
21/01/15 12:18:11 INFO DAGScheduler: Job 16 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:18:11 INFO TaskSchedulerImpl: Killing all running tasks in stage 16: Stage finished
21/01/15 12:18:11 INFO DAGScheduler: Job 16 finished: parquet at Generate.java:61, took 1.097376 s
21/01/15 12:18:11 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-c79fc5ac-19c9-43b5-b7ea-9bedd0bda130
21/01/15 12:18:11 INFO FileFormatWriter: Write Job 11b81eb4-3638-4178-8277-207b384698d7 committed.
21/01/15 12:18:11 INFO FileFormatWriter: Finished processing stats for write job 11b81eb4-3638-4178-8277-207b384698d7.
21/01/15 12:18:12 INFO BlockManagerInfo: Removed broadcast_16_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:18:13 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:13 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:13 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:13 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:13 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:13 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:13 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:13 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:18:13 INFO DAGScheduler: Got job 17 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:18:13 INFO DAGScheduler: Final stage: ResultStage 17 (parquet at Generate.java:61)
21/01/15 12:18:13 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:18:13 INFO DAGScheduler: Missing parents: List()
21/01/15 12:18:13 INFO DAGScheduler: Submitting ResultStage 17 (MapPartitionsRDD[69] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:18:13 INFO MemoryStore: Block broadcast_17 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:18:13 INFO MemoryStore: Block broadcast_17_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:18:13 INFO BlockManagerInfo: Added broadcast_17_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:18:13 INFO SparkContext: Created broadcast 17 from broadcast at DAGScheduler.scala:1223
21/01/15 12:18:13 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 17 (MapPartitionsRDD[69] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:18:13 INFO TaskSchedulerImpl: Adding task set 17.0 with 1 tasks
21/01/15 12:18:13 WARN TaskSetManager: Stage 17 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:18:13 INFO TaskSetManager: Starting task 0.0 in stage 17.0 (TID 17, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:18:13 INFO Executor: Running task 0.0 in stage 17.0 (TID 17)
21/01/15 12:18:13 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:13 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:13 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:13 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:13 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:13 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:13 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:18:13 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:18:13 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:18:13 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:18:13 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:18:13 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:18:13 INFO ParquetOutputFormat: Validation is off
21/01/15 12:18:13 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:18:13 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:18:13 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:18:13 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:18:13 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:18:13 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:18:13 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:18:14 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121813_0017_m_000000_17' to o3fs://bucket1.vol1/testdata
21/01/15 12:18:14 INFO SparkHadoopMapRedUtil: attempt_20210115121813_0017_m_000000_17: Committed
21/01/15 12:18:14 INFO Executor: Finished task 0.0 in stage 17.0 (TID 17). 2155 bytes result sent to driver
21/01/15 12:18:14 INFO TaskSetManager: Finished task 0.0 in stage 17.0 (TID 17) in 989 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:18:14 INFO TaskSchedulerImpl: Removed TaskSet 17.0, whose tasks have all completed, from pool 
21/01/15 12:18:14 INFO DAGScheduler: ResultStage 17 (parquet at Generate.java:61) finished in 1.012 s
21/01/15 12:18:14 INFO DAGScheduler: Job 17 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:18:14 INFO TaskSchedulerImpl: Killing all running tasks in stage 17: Stage finished
21/01/15 12:18:14 INFO DAGScheduler: Job 17 finished: parquet at Generate.java:61, took 1.015010 s
21/01/15 12:18:14 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-22af0e55-2dd9-4b6e-8301-e891aab0c40e
21/01/15 12:18:14 INFO FileFormatWriter: Write Job ff23105f-7109-415a-a633-d81960468f46 committed.
21/01/15 12:18:14 INFO FileFormatWriter: Finished processing stats for write job ff23105f-7109-415a-a633-d81960468f46.
21/01/15 12:18:15 INFO BlockManagerInfo: Removed broadcast_17_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:18:16 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:16 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:16 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:16 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:16 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:16 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:16 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:16 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:18:16 INFO DAGScheduler: Got job 18 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:18:16 INFO DAGScheduler: Final stage: ResultStage 18 (parquet at Generate.java:61)
21/01/15 12:18:16 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:18:16 INFO DAGScheduler: Missing parents: List()
21/01/15 12:18:16 INFO DAGScheduler: Submitting ResultStage 18 (MapPartitionsRDD[73] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:18:16 INFO MemoryStore: Block broadcast_18 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:18:16 INFO MemoryStore: Block broadcast_18_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:18:16 INFO BlockManagerInfo: Added broadcast_18_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:18:16 INFO SparkContext: Created broadcast 18 from broadcast at DAGScheduler.scala:1223
21/01/15 12:18:16 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 18 (MapPartitionsRDD[73] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:18:16 INFO TaskSchedulerImpl: Adding task set 18.0 with 1 tasks
21/01/15 12:18:16 WARN TaskSetManager: Stage 18 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:18:16 INFO TaskSetManager: Starting task 0.0 in stage 18.0 (TID 18, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:18:16 INFO Executor: Running task 0.0 in stage 18.0 (TID 18)
21/01/15 12:18:16 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:16 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:16 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:16 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:16 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:16 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:16 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:18:16 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:18:16 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:18:16 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:18:16 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:18:16 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:18:16 INFO ParquetOutputFormat: Validation is off
21/01/15 12:18:16 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:18:16 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:18:16 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:18:16 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:18:16 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:18:16 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:18:16 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:18:17 INFO RatisMetrics: Creating Metrics Registry : ratis.client_message_metrics.client-320B0A79D8C9->c08b4448-e3e6-4692-885b-be619ea8a953
21/01/15 12:18:17 WARN MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReporterRegistration(...) before.
21/01/15 12:18:17 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121816_0018_m_000000_18' to o3fs://bucket1.vol1/testdata
21/01/15 12:18:17 INFO SparkHadoopMapRedUtil: attempt_20210115121816_0018_m_000000_18: Committed
21/01/15 12:18:17 INFO Executor: Finished task 0.0 in stage 18.0 (TID 18). 2155 bytes result sent to driver
21/01/15 12:18:17 INFO TaskSetManager: Finished task 0.0 in stage 18.0 (TID 18) in 1015 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:18:17 INFO TaskSchedulerImpl: Removed TaskSet 18.0, whose tasks have all completed, from pool 
21/01/15 12:18:17 INFO DAGScheduler: ResultStage 18 (parquet at Generate.java:61) finished in 1.039 s
21/01/15 12:18:17 INFO DAGScheduler: Job 18 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:18:17 INFO TaskSchedulerImpl: Killing all running tasks in stage 18: Stage finished
21/01/15 12:18:17 INFO DAGScheduler: Job 18 finished: parquet at Generate.java:61, took 1.041788 s
21/01/15 12:18:17 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-28bafe7a-451b-4bc9-b400-d83584231bfd
21/01/15 12:18:17 INFO FileFormatWriter: Write Job cd420fb3-2e16-4e4c-929e-abcdb5bdef04 committed.
21/01/15 12:18:17 INFO FileFormatWriter: Finished processing stats for write job cd420fb3-2e16-4e4c-929e-abcdb5bdef04.
21/01/15 12:18:18 INFO BlockManagerInfo: Removed broadcast_18_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:18:19 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:19 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:19 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:19 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:19 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:19 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:19 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:19 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:18:19 INFO DAGScheduler: Got job 19 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:18:19 INFO DAGScheduler: Final stage: ResultStage 19 (parquet at Generate.java:61)
21/01/15 12:18:19 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:18:19 INFO DAGScheduler: Missing parents: List()
21/01/15 12:18:19 INFO DAGScheduler: Submitting ResultStage 19 (MapPartitionsRDD[77] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:18:19 INFO MemoryStore: Block broadcast_19 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:18:19 INFO MemoryStore: Block broadcast_19_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:18:19 INFO BlockManagerInfo: Added broadcast_19_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:18:19 INFO SparkContext: Created broadcast 19 from broadcast at DAGScheduler.scala:1223
21/01/15 12:18:19 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 19 (MapPartitionsRDD[77] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:18:19 INFO TaskSchedulerImpl: Adding task set 19.0 with 1 tasks
21/01/15 12:18:19 WARN TaskSetManager: Stage 19 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:18:19 INFO TaskSetManager: Starting task 0.0 in stage 19.0 (TID 19, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:18:19 INFO Executor: Running task 0.0 in stage 19.0 (TID 19)
21/01/15 12:18:19 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:19 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:19 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:19 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:19 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:19 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:19 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:18:19 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:18:19 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:18:19 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:18:19 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:18:19 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:18:19 INFO ParquetOutputFormat: Validation is off
21/01/15 12:18:19 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:18:19 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:18:19 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:18:19 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:18:19 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:18:19 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:18:19 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:18:20 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121819_0019_m_000000_19' to o3fs://bucket1.vol1/testdata
21/01/15 12:18:20 INFO SparkHadoopMapRedUtil: attempt_20210115121819_0019_m_000000_19: Committed
21/01/15 12:18:20 INFO Executor: Finished task 0.0 in stage 19.0 (TID 19). 2155 bytes result sent to driver
21/01/15 12:18:20 INFO TaskSetManager: Finished task 0.0 in stage 19.0 (TID 19) in 982 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:18:20 INFO TaskSchedulerImpl: Removed TaskSet 19.0, whose tasks have all completed, from pool 
21/01/15 12:18:20 INFO DAGScheduler: ResultStage 19 (parquet at Generate.java:61) finished in 1.005 s
21/01/15 12:18:20 INFO DAGScheduler: Job 19 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:18:20 INFO TaskSchedulerImpl: Killing all running tasks in stage 19: Stage finished
21/01/15 12:18:20 INFO DAGScheduler: Job 19 finished: parquet at Generate.java:61, took 1.009173 s
21/01/15 12:18:20 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-8c8e6727-89ff-401b-a852-fb76389fe279
21/01/15 12:18:20 INFO FileFormatWriter: Write Job a9d2a95a-36e1-4f63-a4c3-5267f7258431 committed.
21/01/15 12:18:20 INFO FileFormatWriter: Finished processing stats for write job a9d2a95a-36e1-4f63-a4c3-5267f7258431.
21/01/15 12:18:20 INFO BlockManagerInfo: Removed broadcast_19_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:18:22 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:22 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:22 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:22 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:22 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:22 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:22 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:22 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:18:22 INFO DAGScheduler: Got job 20 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:18:22 INFO DAGScheduler: Final stage: ResultStage 20 (parquet at Generate.java:61)
21/01/15 12:18:22 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:18:22 INFO DAGScheduler: Missing parents: List()
21/01/15 12:18:22 INFO DAGScheduler: Submitting ResultStage 20 (MapPartitionsRDD[81] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:18:22 INFO MemoryStore: Block broadcast_20 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:18:22 INFO MemoryStore: Block broadcast_20_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:18:22 INFO BlockManagerInfo: Added broadcast_20_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:18:22 INFO SparkContext: Created broadcast 20 from broadcast at DAGScheduler.scala:1223
21/01/15 12:18:22 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 20 (MapPartitionsRDD[81] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:18:22 INFO TaskSchedulerImpl: Adding task set 20.0 with 1 tasks
21/01/15 12:18:22 WARN TaskSetManager: Stage 20 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:18:22 INFO TaskSetManager: Starting task 0.0 in stage 20.0 (TID 20, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:18:22 INFO Executor: Running task 0.0 in stage 20.0 (TID 20)
21/01/15 12:18:22 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:22 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:22 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:22 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:22 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:22 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:22 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:18:22 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:18:22 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:18:22 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:18:22 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:18:22 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:18:22 INFO ParquetOutputFormat: Validation is off
21/01/15 12:18:22 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:18:22 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:18:22 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:18:22 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:18:22 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:18:22 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:18:22 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:18:23 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121822_0020_m_000000_20' to o3fs://bucket1.vol1/testdata
21/01/15 12:18:23 INFO SparkHadoopMapRedUtil: attempt_20210115121822_0020_m_000000_20: Committed
21/01/15 12:18:23 INFO Executor: Finished task 0.0 in stage 20.0 (TID 20). 2155 bytes result sent to driver
21/01/15 12:18:23 INFO TaskSetManager: Finished task 0.0 in stage 20.0 (TID 20) in 1093 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:18:23 INFO TaskSchedulerImpl: Removed TaskSet 20.0, whose tasks have all completed, from pool 
21/01/15 12:18:23 INFO DAGScheduler: ResultStage 20 (parquet at Generate.java:61) finished in 1.115 s
21/01/15 12:18:23 INFO DAGScheduler: Job 20 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:18:23 INFO TaskSchedulerImpl: Killing all running tasks in stage 20: Stage finished
21/01/15 12:18:23 INFO DAGScheduler: Job 20 finished: parquet at Generate.java:61, took 1.117753 s
21/01/15 12:18:23 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-d15ba3e7-ab9a-4c05-85c2-cad41e3a4580
21/01/15 12:18:23 INFO FileFormatWriter: Write Job b3b8ef50-bc8f-4817-a290-cc7daaca5b38 committed.
21/01/15 12:18:23 INFO FileFormatWriter: Finished processing stats for write job b3b8ef50-bc8f-4817-a290-cc7daaca5b38.
21/01/15 12:18:24 INFO BlockManagerInfo: Removed broadcast_20_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:18:25 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:25 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:25 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:25 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:25 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:25 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:25 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:25 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:18:25 INFO DAGScheduler: Got job 21 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:18:25 INFO DAGScheduler: Final stage: ResultStage 21 (parquet at Generate.java:61)
21/01/15 12:18:25 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:18:25 INFO DAGScheduler: Missing parents: List()
21/01/15 12:18:25 INFO DAGScheduler: Submitting ResultStage 21 (MapPartitionsRDD[85] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:18:25 INFO MemoryStore: Block broadcast_21 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:18:25 INFO MemoryStore: Block broadcast_21_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:18:25 INFO BlockManagerInfo: Added broadcast_21_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:18:25 INFO SparkContext: Created broadcast 21 from broadcast at DAGScheduler.scala:1223
21/01/15 12:18:25 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 21 (MapPartitionsRDD[85] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:18:25 INFO TaskSchedulerImpl: Adding task set 21.0 with 1 tasks
21/01/15 12:18:25 WARN TaskSetManager: Stage 21 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:18:25 INFO TaskSetManager: Starting task 0.0 in stage 21.0 (TID 21, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:18:25 INFO Executor: Running task 0.0 in stage 21.0 (TID 21)
21/01/15 12:18:25 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:25 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:25 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:25 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:25 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:25 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:25 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:18:25 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:18:25 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:18:25 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:18:25 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:18:25 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:18:25 INFO ParquetOutputFormat: Validation is off
21/01/15 12:18:25 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:18:25 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:18:25 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:18:25 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:18:25 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:18:25 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:18:25 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:18:26 INFO RatisMetrics: Creating Metrics Registry : ratis.client_message_metrics.client-9324D78F90CB->b27ffd1c-ee20-4b2d-ad86-0a80e9dc1267
21/01/15 12:18:26 WARN MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReporterRegistration(...) before.
21/01/15 12:18:26 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121825_0021_m_000000_21' to o3fs://bucket1.vol1/testdata
21/01/15 12:18:26 INFO SparkHadoopMapRedUtil: attempt_20210115121825_0021_m_000000_21: Committed
21/01/15 12:18:26 INFO Executor: Finished task 0.0 in stage 21.0 (TID 21). 2155 bytes result sent to driver
21/01/15 12:18:26 INFO TaskSetManager: Finished task 0.0 in stage 21.0 (TID 21) in 1059 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:18:26 INFO TaskSchedulerImpl: Removed TaskSet 21.0, whose tasks have all completed, from pool 
21/01/15 12:18:26 INFO DAGScheduler: ResultStage 21 (parquet at Generate.java:61) finished in 1.081 s
21/01/15 12:18:26 INFO DAGScheduler: Job 21 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:18:26 INFO TaskSchedulerImpl: Killing all running tasks in stage 21: Stage finished
21/01/15 12:18:26 INFO DAGScheduler: Job 21 finished: parquet at Generate.java:61, took 1.083413 s
21/01/15 12:18:26 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-798cdbac-5217-4ed9-b9f4-2298b27b2337
21/01/15 12:18:26 INFO FileFormatWriter: Write Job 236f732c-1e17-4cd1-9bf2-d60787ddfcc0 committed.
21/01/15 12:18:26 INFO FileFormatWriter: Finished processing stats for write job 236f732c-1e17-4cd1-9bf2-d60787ddfcc0.
21/01/15 12:18:26 INFO BlockManagerInfo: Removed broadcast_21_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:18:28 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:28 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:28 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:28 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:28 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:28 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:28 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:28 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:18:28 INFO DAGScheduler: Got job 22 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:18:28 INFO DAGScheduler: Final stage: ResultStage 22 (parquet at Generate.java:61)
21/01/15 12:18:28 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:18:28 INFO DAGScheduler: Missing parents: List()
21/01/15 12:18:28 INFO DAGScheduler: Submitting ResultStage 22 (MapPartitionsRDD[89] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:18:28 INFO MemoryStore: Block broadcast_22 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:18:28 INFO MemoryStore: Block broadcast_22_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:18:28 INFO BlockManagerInfo: Added broadcast_22_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:18:28 INFO SparkContext: Created broadcast 22 from broadcast at DAGScheduler.scala:1223
21/01/15 12:18:28 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 22 (MapPartitionsRDD[89] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:18:28 INFO TaskSchedulerImpl: Adding task set 22.0 with 1 tasks
21/01/15 12:18:28 WARN TaskSetManager: Stage 22 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:18:28 INFO TaskSetManager: Starting task 0.0 in stage 22.0 (TID 22, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:18:28 INFO Executor: Running task 0.0 in stage 22.0 (TID 22)
21/01/15 12:18:28 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:28 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:28 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:28 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:28 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:28 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:28 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:18:28 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:18:28 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:18:28 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:18:28 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:18:28 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:18:28 INFO ParquetOutputFormat: Validation is off
21/01/15 12:18:28 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:18:28 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:18:28 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:18:28 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:18:28 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:18:28 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:18:28 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:18:29 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121828_0022_m_000000_22' to o3fs://bucket1.vol1/testdata
21/01/15 12:18:29 INFO SparkHadoopMapRedUtil: attempt_20210115121828_0022_m_000000_22: Committed
21/01/15 12:18:29 INFO Executor: Finished task 0.0 in stage 22.0 (TID 22). 2155 bytes result sent to driver
21/01/15 12:18:29 INFO TaskSetManager: Finished task 0.0 in stage 22.0 (TID 22) in 1000 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:18:29 INFO TaskSchedulerImpl: Removed TaskSet 22.0, whose tasks have all completed, from pool 
21/01/15 12:18:29 INFO DAGScheduler: ResultStage 22 (parquet at Generate.java:61) finished in 1.022 s
21/01/15 12:18:29 INFO DAGScheduler: Job 22 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:18:29 INFO TaskSchedulerImpl: Killing all running tasks in stage 22: Stage finished
21/01/15 12:18:29 INFO DAGScheduler: Job 22 finished: parquet at Generate.java:61, took 1.024480 s
21/01/15 12:18:29 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-08907cd3-c1cb-4041-9165-49c66fdee9d9
21/01/15 12:18:29 INFO FileFormatWriter: Write Job 221da1df-0b4d-4516-8cbb-86b5372f40a8 committed.
21/01/15 12:18:29 INFO FileFormatWriter: Finished processing stats for write job 221da1df-0b4d-4516-8cbb-86b5372f40a8.
21/01/15 12:18:29 INFO BlockManagerInfo: Removed broadcast_22_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:18:31 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:31 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:31 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:31 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:31 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:31 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:31 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:31 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:18:31 INFO DAGScheduler: Got job 23 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:18:31 INFO DAGScheduler: Final stage: ResultStage 23 (parquet at Generate.java:61)
21/01/15 12:18:31 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:18:31 INFO DAGScheduler: Missing parents: List()
21/01/15 12:18:31 INFO DAGScheduler: Submitting ResultStage 23 (MapPartitionsRDD[93] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:18:31 INFO MemoryStore: Block broadcast_23 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:18:31 INFO MemoryStore: Block broadcast_23_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:18:31 INFO BlockManagerInfo: Added broadcast_23_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:18:31 INFO SparkContext: Created broadcast 23 from broadcast at DAGScheduler.scala:1223
21/01/15 12:18:31 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 23 (MapPartitionsRDD[93] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:18:31 INFO TaskSchedulerImpl: Adding task set 23.0 with 1 tasks
21/01/15 12:18:31 WARN TaskSetManager: Stage 23 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:18:31 INFO TaskSetManager: Starting task 0.0 in stage 23.0 (TID 23, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:18:31 INFO Executor: Running task 0.0 in stage 23.0 (TID 23)
21/01/15 12:18:31 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:31 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:31 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:31 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:31 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:31 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:31 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:18:31 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:18:31 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:18:31 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:18:31 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:18:31 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:18:31 INFO ParquetOutputFormat: Validation is off
21/01/15 12:18:31 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:18:31 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:18:31 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:18:31 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:18:31 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:18:31 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:18:31 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:18:32 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121831_0023_m_000000_23' to o3fs://bucket1.vol1/testdata
21/01/15 12:18:32 INFO SparkHadoopMapRedUtil: attempt_20210115121831_0023_m_000000_23: Committed
21/01/15 12:18:32 INFO Executor: Finished task 0.0 in stage 23.0 (TID 23). 2155 bytes result sent to driver
21/01/15 12:18:32 INFO TaskSetManager: Finished task 0.0 in stage 23.0 (TID 23) in 910 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:18:32 INFO TaskSchedulerImpl: Removed TaskSet 23.0, whose tasks have all completed, from pool 
21/01/15 12:18:32 INFO DAGScheduler: ResultStage 23 (parquet at Generate.java:61) finished in 0.933 s
21/01/15 12:18:32 INFO DAGScheduler: Job 23 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:18:32 INFO TaskSchedulerImpl: Killing all running tasks in stage 23: Stage finished
21/01/15 12:18:32 INFO DAGScheduler: Job 23 finished: parquet at Generate.java:61, took 0.934875 s
21/01/15 12:18:32 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-10bb9ace-e2cc-4dbd-9b91-2cca4a6e5a6f
21/01/15 12:18:32 INFO FileFormatWriter: Write Job 4ac8069d-f288-4fd2-aab6-4ced48350d68 committed.
21/01/15 12:18:32 INFO FileFormatWriter: Finished processing stats for write job 4ac8069d-f288-4fd2-aab6-4ced48350d68.
21/01/15 12:18:32 INFO BlockManagerInfo: Removed broadcast_23_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:18:34 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:34 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:34 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:34 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:34 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:34 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:34 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:34 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:18:34 INFO DAGScheduler: Got job 24 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:18:34 INFO DAGScheduler: Final stage: ResultStage 24 (parquet at Generate.java:61)
21/01/15 12:18:34 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:18:34 INFO DAGScheduler: Missing parents: List()
21/01/15 12:18:34 INFO DAGScheduler: Submitting ResultStage 24 (MapPartitionsRDD[97] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:18:34 INFO MemoryStore: Block broadcast_24 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:18:34 INFO MemoryStore: Block broadcast_24_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:18:34 INFO BlockManagerInfo: Added broadcast_24_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:18:34 INFO SparkContext: Created broadcast 24 from broadcast at DAGScheduler.scala:1223
21/01/15 12:18:34 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 24 (MapPartitionsRDD[97] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:18:34 INFO TaskSchedulerImpl: Adding task set 24.0 with 1 tasks
21/01/15 12:18:34 WARN TaskSetManager: Stage 24 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:18:34 INFO TaskSetManager: Starting task 0.0 in stage 24.0 (TID 24, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:18:34 INFO Executor: Running task 0.0 in stage 24.0 (TID 24)
21/01/15 12:18:34 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:34 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:34 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:34 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:34 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:34 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:34 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:18:34 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:18:34 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:18:34 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:18:34 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:18:34 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:18:34 INFO ParquetOutputFormat: Validation is off
21/01/15 12:18:34 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:18:34 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:18:34 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:18:34 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:18:34 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:18:34 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:18:34 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:18:35 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121834_0024_m_000000_24' to o3fs://bucket1.vol1/testdata
21/01/15 12:18:35 INFO SparkHadoopMapRedUtil: attempt_20210115121834_0024_m_000000_24: Committed
21/01/15 12:18:35 INFO Executor: Finished task 0.0 in stage 24.0 (TID 24). 2155 bytes result sent to driver
21/01/15 12:18:35 INFO TaskSetManager: Finished task 0.0 in stage 24.0 (TID 24) in 983 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:18:35 INFO TaskSchedulerImpl: Removed TaskSet 24.0, whose tasks have all completed, from pool 
21/01/15 12:18:35 INFO DAGScheduler: ResultStage 24 (parquet at Generate.java:61) finished in 1.005 s
21/01/15 12:18:35 INFO DAGScheduler: Job 24 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:18:35 INFO TaskSchedulerImpl: Killing all running tasks in stage 24: Stage finished
21/01/15 12:18:35 INFO DAGScheduler: Job 24 finished: parquet at Generate.java:61, took 1.007418 s
21/01/15 12:18:35 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-2e5e8198-4675-4a4a-bc32-32e4a99ed3c7
21/01/15 12:18:35 INFO FileFormatWriter: Write Job d6315c83-f75d-43bc-80ce-0f15c6e18845 committed.
21/01/15 12:18:35 INFO FileFormatWriter: Finished processing stats for write job d6315c83-f75d-43bc-80ce-0f15c6e18845.
21/01/15 12:18:35 INFO BlockManagerInfo: Removed broadcast_24_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:18:36 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:36 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:36 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:36 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:36 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:36 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:36 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:37 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:18:37 INFO DAGScheduler: Got job 25 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:18:37 INFO DAGScheduler: Final stage: ResultStage 25 (parquet at Generate.java:61)
21/01/15 12:18:37 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:18:37 INFO DAGScheduler: Missing parents: List()
21/01/15 12:18:37 INFO DAGScheduler: Submitting ResultStage 25 (MapPartitionsRDD[101] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:18:37 INFO MemoryStore: Block broadcast_25 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:18:37 INFO MemoryStore: Block broadcast_25_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:18:37 INFO BlockManagerInfo: Added broadcast_25_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:18:37 INFO SparkContext: Created broadcast 25 from broadcast at DAGScheduler.scala:1223
21/01/15 12:18:37 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 25 (MapPartitionsRDD[101] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:18:37 INFO TaskSchedulerImpl: Adding task set 25.0 with 1 tasks
21/01/15 12:18:37 WARN TaskSetManager: Stage 25 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:18:37 INFO TaskSetManager: Starting task 0.0 in stage 25.0 (TID 25, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:18:37 INFO Executor: Running task 0.0 in stage 25.0 (TID 25)
21/01/15 12:18:37 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:37 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:37 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:37 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:37 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:37 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:37 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:18:37 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:18:37 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:18:37 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:18:37 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:18:37 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:18:37 INFO ParquetOutputFormat: Validation is off
21/01/15 12:18:37 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:18:37 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:18:37 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:18:37 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:18:37 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:18:37 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:18:37 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:18:38 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121837_0025_m_000000_25' to o3fs://bucket1.vol1/testdata
21/01/15 12:18:38 INFO SparkHadoopMapRedUtil: attempt_20210115121837_0025_m_000000_25: Committed
21/01/15 12:18:38 INFO Executor: Finished task 0.0 in stage 25.0 (TID 25). 2155 bytes result sent to driver
21/01/15 12:18:38 INFO TaskSetManager: Finished task 0.0 in stage 25.0 (TID 25) in 985 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:18:38 INFO TaskSchedulerImpl: Removed TaskSet 25.0, whose tasks have all completed, from pool 
21/01/15 12:18:38 INFO DAGScheduler: ResultStage 25 (parquet at Generate.java:61) finished in 1.007 s
21/01/15 12:18:38 INFO DAGScheduler: Job 25 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:18:38 INFO TaskSchedulerImpl: Killing all running tasks in stage 25: Stage finished
21/01/15 12:18:38 INFO DAGScheduler: Job 25 finished: parquet at Generate.java:61, took 1.009363 s
21/01/15 12:18:38 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-b1516def-a934-4486-86bc-99481fd32a12
21/01/15 12:18:38 INFO FileFormatWriter: Write Job 07c93587-2236-4449-b6d7-19aa39ae1f12 committed.
21/01/15 12:18:38 INFO FileFormatWriter: Finished processing stats for write job 07c93587-2236-4449-b6d7-19aa39ae1f12.
21/01/15 12:18:38 INFO BlockManagerInfo: Removed broadcast_25_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:18:39 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:39 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:39 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:39 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:39 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:39 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:39 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:39 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:18:39 INFO DAGScheduler: Got job 26 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:18:39 INFO DAGScheduler: Final stage: ResultStage 26 (parquet at Generate.java:61)
21/01/15 12:18:39 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:18:39 INFO DAGScheduler: Missing parents: List()
21/01/15 12:18:39 INFO DAGScheduler: Submitting ResultStage 26 (MapPartitionsRDD[105] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:18:39 INFO MemoryStore: Block broadcast_26 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:18:39 INFO MemoryStore: Block broadcast_26_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:18:39 INFO BlockManagerInfo: Added broadcast_26_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:18:39 INFO SparkContext: Created broadcast 26 from broadcast at DAGScheduler.scala:1223
21/01/15 12:18:39 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 26 (MapPartitionsRDD[105] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:18:39 INFO TaskSchedulerImpl: Adding task set 26.0 with 1 tasks
21/01/15 12:18:40 WARN TaskSetManager: Stage 26 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:18:40 INFO TaskSetManager: Starting task 0.0 in stage 26.0 (TID 26, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:18:40 INFO Executor: Running task 0.0 in stage 26.0 (TID 26)
21/01/15 12:18:40 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:40 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:40 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:40 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:40 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:40 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:40 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:18:40 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:18:40 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:18:40 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:18:40 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:18:40 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:18:40 INFO ParquetOutputFormat: Validation is off
21/01/15 12:18:40 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:18:40 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:18:40 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:18:40 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:18:40 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:18:40 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:18:40 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:18:40 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121839_0026_m_000000_26' to o3fs://bucket1.vol1/testdata
21/01/15 12:18:40 INFO SparkHadoopMapRedUtil: attempt_20210115121839_0026_m_000000_26: Committed
21/01/15 12:18:40 INFO Executor: Finished task 0.0 in stage 26.0 (TID 26). 2155 bytes result sent to driver
21/01/15 12:18:40 INFO TaskSetManager: Finished task 0.0 in stage 26.0 (TID 26) in 995 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:18:40 INFO TaskSchedulerImpl: Removed TaskSet 26.0, whose tasks have all completed, from pool 
21/01/15 12:18:40 INFO DAGScheduler: ResultStage 26 (parquet at Generate.java:61) finished in 1.019 s
21/01/15 12:18:40 INFO DAGScheduler: Job 26 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:18:40 INFO TaskSchedulerImpl: Killing all running tasks in stage 26: Stage finished
21/01/15 12:18:40 INFO DAGScheduler: Job 26 finished: parquet at Generate.java:61, took 1.021531 s
21/01/15 12:18:40 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-c1fd535a-0775-4d74-b54e-352027a8206b
21/01/15 12:18:40 INFO FileFormatWriter: Write Job bae3639b-190c-439b-b633-1ce2a7e82851 committed.
21/01/15 12:18:40 INFO FileFormatWriter: Finished processing stats for write job bae3639b-190c-439b-b633-1ce2a7e82851.
21/01/15 12:18:41 INFO BlockManagerInfo: Removed broadcast_26_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:18:42 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:42 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:42 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:42 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:42 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:42 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:42 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:42 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:18:42 INFO DAGScheduler: Got job 27 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:18:42 INFO DAGScheduler: Final stage: ResultStage 27 (parquet at Generate.java:61)
21/01/15 12:18:42 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:18:42 INFO DAGScheduler: Missing parents: List()
21/01/15 12:18:42 INFO DAGScheduler: Submitting ResultStage 27 (MapPartitionsRDD[109] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:18:42 INFO MemoryStore: Block broadcast_27 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:18:42 INFO MemoryStore: Block broadcast_27_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:18:42 INFO BlockManagerInfo: Added broadcast_27_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:18:42 INFO SparkContext: Created broadcast 27 from broadcast at DAGScheduler.scala:1223
21/01/15 12:18:42 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 27 (MapPartitionsRDD[109] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:18:42 INFO TaskSchedulerImpl: Adding task set 27.0 with 1 tasks
21/01/15 12:18:42 WARN TaskSetManager: Stage 27 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:18:42 INFO TaskSetManager: Starting task 0.0 in stage 27.0 (TID 27, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:18:42 INFO Executor: Running task 0.0 in stage 27.0 (TID 27)
21/01/15 12:18:42 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:42 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:42 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:42 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:42 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:42 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:42 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:18:42 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:18:42 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:18:42 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:18:42 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:18:42 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:18:42 INFO ParquetOutputFormat: Validation is off
21/01/15 12:18:42 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:18:42 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:18:42 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:18:42 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:18:42 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:18:42 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:18:43 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:18:43 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121842_0027_m_000000_27' to o3fs://bucket1.vol1/testdata
21/01/15 12:18:43 INFO SparkHadoopMapRedUtil: attempt_20210115121842_0027_m_000000_27: Committed
21/01/15 12:18:43 INFO Executor: Finished task 0.0 in stage 27.0 (TID 27). 2155 bytes result sent to driver
21/01/15 12:18:43 INFO TaskSetManager: Finished task 0.0 in stage 27.0 (TID 27) in 1044 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:18:43 INFO TaskSchedulerImpl: Removed TaskSet 27.0, whose tasks have all completed, from pool 
21/01/15 12:18:43 INFO DAGScheduler: ResultStage 27 (parquet at Generate.java:61) finished in 1.067 s
21/01/15 12:18:43 INFO DAGScheduler: Job 27 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:18:43 INFO TaskSchedulerImpl: Killing all running tasks in stage 27: Stage finished
21/01/15 12:18:43 INFO DAGScheduler: Job 27 finished: parquet at Generate.java:61, took 1.068915 s
21/01/15 12:18:43 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-11cf578f-3836-4474-a82f-f482e8952674
21/01/15 12:18:43 INFO FileFormatWriter: Write Job 935cac41-ded1-4c26-8b52-6fc1bbf14bcb committed.
21/01/15 12:18:43 INFO FileFormatWriter: Finished processing stats for write job 935cac41-ded1-4c26-8b52-6fc1bbf14bcb.
21/01/15 12:18:44 INFO BlockManagerInfo: Removed broadcast_27_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:18:45 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:45 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:45 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:45 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:45 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:45 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:45 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:45 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:18:45 INFO DAGScheduler: Got job 28 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:18:45 INFO DAGScheduler: Final stage: ResultStage 28 (parquet at Generate.java:61)
21/01/15 12:18:45 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:18:45 INFO DAGScheduler: Missing parents: List()
21/01/15 12:18:45 INFO DAGScheduler: Submitting ResultStage 28 (MapPartitionsRDD[113] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:18:45 INFO MemoryStore: Block broadcast_28 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:18:45 INFO MemoryStore: Block broadcast_28_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:18:45 INFO BlockManagerInfo: Added broadcast_28_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:18:45 INFO SparkContext: Created broadcast 28 from broadcast at DAGScheduler.scala:1223
21/01/15 12:18:45 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 28 (MapPartitionsRDD[113] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:18:45 INFO TaskSchedulerImpl: Adding task set 28.0 with 1 tasks
21/01/15 12:18:45 WARN TaskSetManager: Stage 28 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:18:45 INFO TaskSetManager: Starting task 0.0 in stage 28.0 (TID 28, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:18:45 INFO Executor: Running task 0.0 in stage 28.0 (TID 28)
21/01/15 12:18:45 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:45 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:45 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:45 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:45 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:45 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:45 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:18:45 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:18:45 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:18:45 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:18:45 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:18:45 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:18:45 INFO ParquetOutputFormat: Validation is off
21/01/15 12:18:45 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:18:45 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:18:45 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:18:45 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:18:45 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:18:45 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:18:45 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:18:46 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121845_0028_m_000000_28' to o3fs://bucket1.vol1/testdata
21/01/15 12:18:46 INFO SparkHadoopMapRedUtil: attempt_20210115121845_0028_m_000000_28: Committed
21/01/15 12:18:46 INFO Executor: Finished task 0.0 in stage 28.0 (TID 28). 2155 bytes result sent to driver
21/01/15 12:18:46 INFO TaskSetManager: Finished task 0.0 in stage 28.0 (TID 28) in 978 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:18:46 INFO TaskSchedulerImpl: Removed TaskSet 28.0, whose tasks have all completed, from pool 
21/01/15 12:18:46 INFO DAGScheduler: ResultStage 28 (parquet at Generate.java:61) finished in 1.004 s
21/01/15 12:18:46 INFO DAGScheduler: Job 28 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:18:46 INFO TaskSchedulerImpl: Killing all running tasks in stage 28: Stage finished
21/01/15 12:18:46 INFO DAGScheduler: Job 28 finished: parquet at Generate.java:61, took 1.007160 s
21/01/15 12:18:46 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-c46584b6-53a6-4a4e-b460-511e858f5713
21/01/15 12:18:46 INFO FileFormatWriter: Write Job 06c7d31f-4ffe-4265-8ce1-21df4f8ac3d2 committed.
21/01/15 12:18:46 INFO FileFormatWriter: Finished processing stats for write job 06c7d31f-4ffe-4265-8ce1-21df4f8ac3d2.
21/01/15 12:18:47 INFO BlockManagerInfo: Removed broadcast_28_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:18:48 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:48 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:48 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:48 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:48 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:48 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:48 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:48 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:18:48 INFO DAGScheduler: Got job 29 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:18:48 INFO DAGScheduler: Final stage: ResultStage 29 (parquet at Generate.java:61)
21/01/15 12:18:48 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:18:48 INFO DAGScheduler: Missing parents: List()
21/01/15 12:18:48 INFO DAGScheduler: Submitting ResultStage 29 (MapPartitionsRDD[117] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:18:48 INFO MemoryStore: Block broadcast_29 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:18:48 INFO MemoryStore: Block broadcast_29_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:18:48 INFO BlockManagerInfo: Added broadcast_29_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:18:48 INFO SparkContext: Created broadcast 29 from broadcast at DAGScheduler.scala:1223
21/01/15 12:18:48 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 29 (MapPartitionsRDD[117] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:18:48 INFO TaskSchedulerImpl: Adding task set 29.0 with 1 tasks
21/01/15 12:18:48 WARN TaskSetManager: Stage 29 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:18:48 INFO TaskSetManager: Starting task 0.0 in stage 29.0 (TID 29, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:18:48 INFO Executor: Running task 0.0 in stage 29.0 (TID 29)
21/01/15 12:18:48 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:48 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:48 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:48 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:48 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:48 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:48 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:18:48 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:18:48 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:18:48 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:18:48 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:18:48 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:18:48 INFO ParquetOutputFormat: Validation is off
21/01/15 12:18:48 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:18:48 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:18:48 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:18:48 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:18:48 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:18:48 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:18:49 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:18:49 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121848_0029_m_000000_29' to o3fs://bucket1.vol1/testdata
21/01/15 12:18:49 INFO SparkHadoopMapRedUtil: attempt_20210115121848_0029_m_000000_29: Committed
21/01/15 12:18:49 INFO Executor: Finished task 0.0 in stage 29.0 (TID 29). 2155 bytes result sent to driver
21/01/15 12:18:49 INFO TaskSetManager: Finished task 0.0 in stage 29.0 (TID 29) in 986 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:18:49 INFO TaskSchedulerImpl: Removed TaskSet 29.0, whose tasks have all completed, from pool 
21/01/15 12:18:49 INFO DAGScheduler: ResultStage 29 (parquet at Generate.java:61) finished in 1.010 s
21/01/15 12:18:49 INFO DAGScheduler: Job 29 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:18:49 INFO TaskSchedulerImpl: Killing all running tasks in stage 29: Stage finished
21/01/15 12:18:49 INFO DAGScheduler: Job 29 finished: parquet at Generate.java:61, took 1.011762 s
21/01/15 12:18:49 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-4dea878a-213d-403b-aadc-a63bbf9eb9d0
21/01/15 12:18:49 INFO FileFormatWriter: Write Job 191ccd30-6687-4a28-9010-e18778e87b9c committed.
21/01/15 12:18:49 INFO FileFormatWriter: Finished processing stats for write job 191ccd30-6687-4a28-9010-e18778e87b9c.
21/01/15 12:18:50 INFO BlockManagerInfo: Removed broadcast_29_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:18:51 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:51 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:51 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:51 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:51 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:51 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:51 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:51 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:18:51 INFO DAGScheduler: Got job 30 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:18:51 INFO DAGScheduler: Final stage: ResultStage 30 (parquet at Generate.java:61)
21/01/15 12:18:51 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:18:51 INFO DAGScheduler: Missing parents: List()
21/01/15 12:18:51 INFO DAGScheduler: Submitting ResultStage 30 (MapPartitionsRDD[121] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:18:51 INFO MemoryStore: Block broadcast_30 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:18:51 INFO MemoryStore: Block broadcast_30_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:18:51 INFO BlockManagerInfo: Added broadcast_30_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:18:51 INFO SparkContext: Created broadcast 30 from broadcast at DAGScheduler.scala:1223
21/01/15 12:18:51 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 30 (MapPartitionsRDD[121] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:18:51 INFO TaskSchedulerImpl: Adding task set 30.0 with 1 tasks
21/01/15 12:18:51 WARN TaskSetManager: Stage 30 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:18:51 INFO TaskSetManager: Starting task 0.0 in stage 30.0 (TID 30, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:18:51 INFO Executor: Running task 0.0 in stage 30.0 (TID 30)
21/01/15 12:18:51 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:51 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:51 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:51 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:51 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:51 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:51 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:18:51 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:18:51 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:18:51 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:18:51 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:18:51 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:18:51 INFO ParquetOutputFormat: Validation is off
21/01/15 12:18:51 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:18:51 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:18:51 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:18:51 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:18:51 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:18:51 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:18:51 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:18:52 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121851_0030_m_000000_30' to o3fs://bucket1.vol1/testdata
21/01/15 12:18:52 INFO SparkHadoopMapRedUtil: attempt_20210115121851_0030_m_000000_30: Committed
21/01/15 12:18:52 INFO Executor: Finished task 0.0 in stage 30.0 (TID 30). 2155 bytes result sent to driver
21/01/15 12:18:52 INFO TaskSetManager: Finished task 0.0 in stage 30.0 (TID 30) in 905 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:18:52 INFO TaskSchedulerImpl: Removed TaskSet 30.0, whose tasks have all completed, from pool 
21/01/15 12:18:52 INFO DAGScheduler: ResultStage 30 (parquet at Generate.java:61) finished in 0.926 s
21/01/15 12:18:52 INFO DAGScheduler: Job 30 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:18:52 INFO TaskSchedulerImpl: Killing all running tasks in stage 30: Stage finished
21/01/15 12:18:52 INFO DAGScheduler: Job 30 finished: parquet at Generate.java:61, took 0.928345 s
21/01/15 12:18:52 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-f2c3ad4a-c6a0-4877-8ad1-9579865340fa
21/01/15 12:18:52 INFO FileFormatWriter: Write Job 8d053ca6-eca5-49e6-b1c7-e62305400d7e committed.
21/01/15 12:18:52 INFO FileFormatWriter: Finished processing stats for write job 8d053ca6-eca5-49e6-b1c7-e62305400d7e.
21/01/15 12:18:52 INFO BlockManagerInfo: Removed broadcast_30_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:18:54 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:54 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:54 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:54 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:54 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:54 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:54 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:54 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:18:54 INFO DAGScheduler: Got job 31 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:18:54 INFO DAGScheduler: Final stage: ResultStage 31 (parquet at Generate.java:61)
21/01/15 12:18:54 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:18:54 INFO DAGScheduler: Missing parents: List()
21/01/15 12:18:54 INFO DAGScheduler: Submitting ResultStage 31 (MapPartitionsRDD[125] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:18:54 INFO MemoryStore: Block broadcast_31 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:18:54 INFO MemoryStore: Block broadcast_31_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:18:54 INFO BlockManagerInfo: Added broadcast_31_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:18:54 INFO SparkContext: Created broadcast 31 from broadcast at DAGScheduler.scala:1223
21/01/15 12:18:54 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 31 (MapPartitionsRDD[125] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:18:54 INFO TaskSchedulerImpl: Adding task set 31.0 with 1 tasks
21/01/15 12:18:54 WARN TaskSetManager: Stage 31 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:18:54 INFO TaskSetManager: Starting task 0.0 in stage 31.0 (TID 31, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:18:54 INFO Executor: Running task 0.0 in stage 31.0 (TID 31)
21/01/15 12:18:54 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:54 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:54 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:54 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:54 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:54 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:54 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:18:54 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:18:54 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:18:54 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:18:54 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:18:54 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:18:54 INFO ParquetOutputFormat: Validation is off
21/01/15 12:18:54 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:18:54 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:18:54 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:18:54 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:18:54 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:18:54 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:18:54 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:18:55 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121854_0031_m_000000_31' to o3fs://bucket1.vol1/testdata
21/01/15 12:18:55 INFO SparkHadoopMapRedUtil: attempt_20210115121854_0031_m_000000_31: Committed
21/01/15 12:18:55 INFO Executor: Finished task 0.0 in stage 31.0 (TID 31). 2155 bytes result sent to driver
21/01/15 12:18:55 INFO TaskSetManager: Finished task 0.0 in stage 31.0 (TID 31) in 989 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:18:55 INFO TaskSchedulerImpl: Removed TaskSet 31.0, whose tasks have all completed, from pool 
21/01/15 12:18:55 INFO DAGScheduler: ResultStage 31 (parquet at Generate.java:61) finished in 1.010 s
21/01/15 12:18:55 INFO DAGScheduler: Job 31 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:18:55 INFO TaskSchedulerImpl: Killing all running tasks in stage 31: Stage finished
21/01/15 12:18:55 INFO DAGScheduler: Job 31 finished: parquet at Generate.java:61, took 1.013032 s
21/01/15 12:18:55 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-6e708f2e-2b41-4a23-809d-fc62b85ac759
21/01/15 12:18:55 INFO FileFormatWriter: Write Job 4208e6ff-b9b7-4fa0-aa96-942ec4084dd5 committed.
21/01/15 12:18:55 INFO FileFormatWriter: Finished processing stats for write job 4208e6ff-b9b7-4fa0-aa96-942ec4084dd5.
21/01/15 12:18:55 INFO BlockManagerInfo: Removed broadcast_31_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:18:57 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:57 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:57 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:57 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:57 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:57 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:57 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:57 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:18:57 INFO DAGScheduler: Got job 32 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:18:57 INFO DAGScheduler: Final stage: ResultStage 32 (parquet at Generate.java:61)
21/01/15 12:18:57 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:18:57 INFO DAGScheduler: Missing parents: List()
21/01/15 12:18:57 INFO DAGScheduler: Submitting ResultStage 32 (MapPartitionsRDD[129] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:18:57 INFO MemoryStore: Block broadcast_32 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:18:57 INFO MemoryStore: Block broadcast_32_piece0 stored as bytes in memory (estimated size 73.5 KiB, free 413.7 MiB)
21/01/15 12:18:57 INFO BlockManagerInfo: Added broadcast_32_piece0 in memory on test-runner-nc6ld:33443 (size: 73.5 KiB, free: 413.9 MiB)
21/01/15 12:18:57 INFO SparkContext: Created broadcast 32 from broadcast at DAGScheduler.scala:1223
21/01/15 12:18:57 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 32 (MapPartitionsRDD[129] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:18:57 INFO TaskSchedulerImpl: Adding task set 32.0 with 1 tasks
21/01/15 12:18:57 WARN TaskSetManager: Stage 32 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:18:57 INFO TaskSetManager: Starting task 0.0 in stage 32.0 (TID 32, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:18:57 INFO Executor: Running task 0.0 in stage 32.0 (TID 32)
21/01/15 12:18:57 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:57 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:57 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:57 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:18:57 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:18:57 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:18:57 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:18:57 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:18:57 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:18:57 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:18:57 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:18:57 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:18:57 INFO ParquetOutputFormat: Validation is off
21/01/15 12:18:57 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:18:57 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:18:57 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:18:57 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:18:57 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:18:57 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:18:57 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:18:58 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121857_0032_m_000000_32' to o3fs://bucket1.vol1/testdata
21/01/15 12:18:58 INFO SparkHadoopMapRedUtil: attempt_20210115121857_0032_m_000000_32: Committed
21/01/15 12:18:58 INFO Executor: Finished task 0.0 in stage 32.0 (TID 32). 2155 bytes result sent to driver
21/01/15 12:18:58 INFO TaskSetManager: Finished task 0.0 in stage 32.0 (TID 32) in 986 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:18:58 INFO TaskSchedulerImpl: Removed TaskSet 32.0, whose tasks have all completed, from pool 
21/01/15 12:18:58 INFO DAGScheduler: ResultStage 32 (parquet at Generate.java:61) finished in 1.006 s
21/01/15 12:18:58 INFO DAGScheduler: Job 32 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:18:58 INFO TaskSchedulerImpl: Killing all running tasks in stage 32: Stage finished
21/01/15 12:18:58 INFO DAGScheduler: Job 32 finished: parquet at Generate.java:61, took 1.008940 s
21/01/15 12:18:58 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-fc92c35e-9230-4236-ae30-a71a664dba8f
21/01/15 12:18:58 INFO FileFormatWriter: Write Job 188c93c3-32ac-42b7-a193-b90746b81e09 committed.
21/01/15 12:18:58 INFO FileFormatWriter: Finished processing stats for write job 188c93c3-32ac-42b7-a193-b90746b81e09.
21/01/15 12:18:58 INFO BlockManagerInfo: Removed broadcast_32_piece0 on test-runner-nc6ld:33443 in memory (size: 73.5 KiB, free: 413.9 MiB)
21/01/15 12:19:00 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:00 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:00 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:00 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:00 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:00 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:00 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:00 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:19:00 INFO DAGScheduler: Got job 33 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:19:00 INFO DAGScheduler: Final stage: ResultStage 33 (parquet at Generate.java:61)
21/01/15 12:19:00 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:19:00 INFO DAGScheduler: Missing parents: List()
21/01/15 12:19:00 INFO DAGScheduler: Submitting ResultStage 33 (MapPartitionsRDD[133] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:19:00 INFO MemoryStore: Block broadcast_33 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:19:00 INFO MemoryStore: Block broadcast_33_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:19:00 INFO BlockManagerInfo: Added broadcast_33_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:19:00 INFO SparkContext: Created broadcast 33 from broadcast at DAGScheduler.scala:1223
21/01/15 12:19:00 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 33 (MapPartitionsRDD[133] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:19:00 INFO TaskSchedulerImpl: Adding task set 33.0 with 1 tasks
21/01/15 12:19:00 WARN TaskSetManager: Stage 33 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:19:00 INFO TaskSetManager: Starting task 0.0 in stage 33.0 (TID 33, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:19:00 INFO Executor: Running task 0.0 in stage 33.0 (TID 33)
21/01/15 12:19:00 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:00 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:00 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:00 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:00 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:00 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:00 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:19:00 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:19:00 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:19:00 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:19:00 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:19:00 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:19:00 INFO ParquetOutputFormat: Validation is off
21/01/15 12:19:00 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:19:00 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:19:00 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:19:00 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:19:00 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:19:00 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:19:00 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:19:00 INFO RatisMetrics: Creating Metrics Registry : ratis.client_message_metrics.client-534C2EB1B8A7->c08b4448-e3e6-4692-885b-be619ea8a953
21/01/15 12:19:00 WARN MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReporterRegistration(...) before.
21/01/15 12:19:01 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121900_0033_m_000000_33' to o3fs://bucket1.vol1/testdata
21/01/15 12:19:01 INFO SparkHadoopMapRedUtil: attempt_20210115121900_0033_m_000000_33: Committed
21/01/15 12:19:01 INFO Executor: Finished task 0.0 in stage 33.0 (TID 33). 2155 bytes result sent to driver
21/01/15 12:19:01 INFO TaskSetManager: Finished task 0.0 in stage 33.0 (TID 33) in 1001 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:19:01 INFO TaskSchedulerImpl: Removed TaskSet 33.0, whose tasks have all completed, from pool 
21/01/15 12:19:01 INFO DAGScheduler: ResultStage 33 (parquet at Generate.java:61) finished in 1.023 s
21/01/15 12:19:01 INFO DAGScheduler: Job 33 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:19:01 INFO TaskSchedulerImpl: Killing all running tasks in stage 33: Stage finished
21/01/15 12:19:01 INFO DAGScheduler: Job 33 finished: parquet at Generate.java:61, took 1.024839 s
21/01/15 12:19:01 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-9dc04852-891f-45ee-ac8d-3ff6940feb15
21/01/15 12:19:01 INFO FileFormatWriter: Write Job 27969fba-b8ae-4fc8-93a2-7f2ba804ddcc committed.
21/01/15 12:19:01 INFO FileFormatWriter: Finished processing stats for write job 27969fba-b8ae-4fc8-93a2-7f2ba804ddcc.
21/01/15 12:19:01 INFO BlockManagerInfo: Removed broadcast_33_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:19:03 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:03 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:03 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:03 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:03 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:03 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:03 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:03 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:19:03 INFO DAGScheduler: Got job 34 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:19:03 INFO DAGScheduler: Final stage: ResultStage 34 (parquet at Generate.java:61)
21/01/15 12:19:03 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:19:03 INFO DAGScheduler: Missing parents: List()
21/01/15 12:19:03 INFO DAGScheduler: Submitting ResultStage 34 (MapPartitionsRDD[137] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:19:03 INFO MemoryStore: Block broadcast_34 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:19:03 INFO MemoryStore: Block broadcast_34_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:19:03 INFO BlockManagerInfo: Added broadcast_34_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:19:03 INFO SparkContext: Created broadcast 34 from broadcast at DAGScheduler.scala:1223
21/01/15 12:19:03 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 34 (MapPartitionsRDD[137] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:19:03 INFO TaskSchedulerImpl: Adding task set 34.0 with 1 tasks
21/01/15 12:19:03 WARN TaskSetManager: Stage 34 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:19:03 INFO TaskSetManager: Starting task 0.0 in stage 34.0 (TID 34, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:19:03 INFO Executor: Running task 0.0 in stage 34.0 (TID 34)
21/01/15 12:19:03 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:03 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:03 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:03 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:03 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:03 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:03 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:19:03 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:19:03 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:19:03 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:19:03 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:19:03 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:19:03 INFO ParquetOutputFormat: Validation is off
21/01/15 12:19:03 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:19:03 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:19:03 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:19:03 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:19:03 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:19:03 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:19:03 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:19:04 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121903_0034_m_000000_34' to o3fs://bucket1.vol1/testdata
21/01/15 12:19:04 INFO SparkHadoopMapRedUtil: attempt_20210115121903_0034_m_000000_34: Committed
21/01/15 12:19:04 INFO Executor: Finished task 0.0 in stage 34.0 (TID 34). 2155 bytes result sent to driver
21/01/15 12:19:04 INFO TaskSetManager: Finished task 0.0 in stage 34.0 (TID 34) in 1059 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:19:04 INFO TaskSchedulerImpl: Removed TaskSet 34.0, whose tasks have all completed, from pool 
21/01/15 12:19:04 INFO DAGScheduler: ResultStage 34 (parquet at Generate.java:61) finished in 1.081 s
21/01/15 12:19:04 INFO DAGScheduler: Job 34 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:19:04 INFO TaskSchedulerImpl: Killing all running tasks in stage 34: Stage finished
21/01/15 12:19:04 INFO DAGScheduler: Job 34 finished: parquet at Generate.java:61, took 1.082821 s
21/01/15 12:19:04 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-6272cf8d-fa45-4dfe-8d4a-7562430ebe60
21/01/15 12:19:04 INFO FileFormatWriter: Write Job 306dee7e-8a69-4dd4-9614-6dd99ccb7764 committed.
21/01/15 12:19:04 INFO FileFormatWriter: Finished processing stats for write job 306dee7e-8a69-4dd4-9614-6dd99ccb7764.
21/01/15 12:19:04 INFO BlockManagerInfo: Removed broadcast_34_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:19:05 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:05 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:05 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:05 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:05 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:05 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:05 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:06 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:19:06 INFO DAGScheduler: Got job 35 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:19:06 INFO DAGScheduler: Final stage: ResultStage 35 (parquet at Generate.java:61)
21/01/15 12:19:06 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:19:06 INFO DAGScheduler: Missing parents: List()
21/01/15 12:19:06 INFO DAGScheduler: Submitting ResultStage 35 (MapPartitionsRDD[141] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:19:06 INFO MemoryStore: Block broadcast_35 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:19:06 INFO MemoryStore: Block broadcast_35_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:19:06 INFO BlockManagerInfo: Added broadcast_35_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:19:06 INFO SparkContext: Created broadcast 35 from broadcast at DAGScheduler.scala:1223
21/01/15 12:19:06 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 35 (MapPartitionsRDD[141] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:19:06 INFO TaskSchedulerImpl: Adding task set 35.0 with 1 tasks
21/01/15 12:19:06 WARN TaskSetManager: Stage 35 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:19:06 INFO TaskSetManager: Starting task 0.0 in stage 35.0 (TID 35, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:19:06 INFO Executor: Running task 0.0 in stage 35.0 (TID 35)
21/01/15 12:19:06 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:06 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:06 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:06 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:06 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:06 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:06 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:19:06 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:19:06 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:19:06 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:19:06 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:19:06 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:19:06 INFO ParquetOutputFormat: Validation is off
21/01/15 12:19:06 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:19:06 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:19:06 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:19:06 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:19:06 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:19:06 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:19:06 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:19:07 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121906_0035_m_000000_35' to o3fs://bucket1.vol1/testdata
21/01/15 12:19:07 INFO SparkHadoopMapRedUtil: attempt_20210115121906_0035_m_000000_35: Committed
21/01/15 12:19:07 INFO Executor: Finished task 0.0 in stage 35.0 (TID 35). 2155 bytes result sent to driver
21/01/15 12:19:07 INFO TaskSetManager: Finished task 0.0 in stage 35.0 (TID 35) in 1153 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:19:07 INFO TaskSchedulerImpl: Removed TaskSet 35.0, whose tasks have all completed, from pool 
21/01/15 12:19:07 INFO DAGScheduler: ResultStage 35 (parquet at Generate.java:61) finished in 1.175 s
21/01/15 12:19:07 INFO DAGScheduler: Job 35 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:19:07 INFO TaskSchedulerImpl: Killing all running tasks in stage 35: Stage finished
21/01/15 12:19:07 INFO DAGScheduler: Job 35 finished: parquet at Generate.java:61, took 1.176985 s
21/01/15 12:19:07 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-dee7eef8-b3f3-45fd-8ad5-041123194e7d
21/01/15 12:19:07 INFO FileFormatWriter: Write Job 345cc5ff-34df-4123-9031-9a0f25525e6f committed.
21/01/15 12:19:07 INFO FileFormatWriter: Finished processing stats for write job 345cc5ff-34df-4123-9031-9a0f25525e6f.
21/01/15 12:19:07 INFO BlockManagerInfo: Removed broadcast_35_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:19:09 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:09 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:09 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:09 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:09 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:09 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:09 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:09 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:19:09 INFO DAGScheduler: Got job 36 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:19:09 INFO DAGScheduler: Final stage: ResultStage 36 (parquet at Generate.java:61)
21/01/15 12:19:09 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:19:09 INFO DAGScheduler: Missing parents: List()
21/01/15 12:19:09 INFO DAGScheduler: Submitting ResultStage 36 (MapPartitionsRDD[145] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:19:09 INFO MemoryStore: Block broadcast_36 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:19:09 INFO MemoryStore: Block broadcast_36_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:19:09 INFO BlockManagerInfo: Added broadcast_36_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:19:09 INFO SparkContext: Created broadcast 36 from broadcast at DAGScheduler.scala:1223
21/01/15 12:19:09 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 36 (MapPartitionsRDD[145] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:19:09 INFO TaskSchedulerImpl: Adding task set 36.0 with 1 tasks
21/01/15 12:19:09 WARN TaskSetManager: Stage 36 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:19:09 INFO TaskSetManager: Starting task 0.0 in stage 36.0 (TID 36, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:19:09 INFO Executor: Running task 0.0 in stage 36.0 (TID 36)
21/01/15 12:19:09 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:09 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:09 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:09 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:09 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:09 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:09 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:19:09 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:19:09 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:19:09 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:19:09 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:19:09 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:19:09 INFO ParquetOutputFormat: Validation is off
21/01/15 12:19:09 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:19:09 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:19:09 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:19:09 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:19:09 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:19:09 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:19:09 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:19:10 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121909_0036_m_000000_36' to o3fs://bucket1.vol1/testdata
21/01/15 12:19:10 INFO SparkHadoopMapRedUtil: attempt_20210115121909_0036_m_000000_36: Committed
21/01/15 12:19:10 INFO Executor: Finished task 0.0 in stage 36.0 (TID 36). 2155 bytes result sent to driver
21/01/15 12:19:10 INFO TaskSetManager: Finished task 0.0 in stage 36.0 (TID 36) in 970 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:19:10 INFO TaskSchedulerImpl: Removed TaskSet 36.0, whose tasks have all completed, from pool 
21/01/15 12:19:10 INFO DAGScheduler: ResultStage 36 (parquet at Generate.java:61) finished in 0.992 s
21/01/15 12:19:10 INFO DAGScheduler: Job 36 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:19:10 INFO TaskSchedulerImpl: Killing all running tasks in stage 36: Stage finished
21/01/15 12:19:10 INFO DAGScheduler: Job 36 finished: parquet at Generate.java:61, took 0.994228 s
21/01/15 12:19:10 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-e26a27f5-26ad-474c-8995-9449e8cf4a9c
21/01/15 12:19:10 INFO FileFormatWriter: Write Job ab0b6f9e-b155-428b-a30c-52d1eec185f0 committed.
21/01/15 12:19:10 INFO FileFormatWriter: Finished processing stats for write job ab0b6f9e-b155-428b-a30c-52d1eec185f0.
21/01/15 12:19:10 INFO BlockManagerInfo: Removed broadcast_36_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:19:11 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:11 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:11 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:11 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:11 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:11 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:11 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:11 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:19:11 INFO DAGScheduler: Got job 37 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:19:11 INFO DAGScheduler: Final stage: ResultStage 37 (parquet at Generate.java:61)
21/01/15 12:19:11 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:19:11 INFO DAGScheduler: Missing parents: List()
21/01/15 12:19:11 INFO DAGScheduler: Submitting ResultStage 37 (MapPartitionsRDD[149] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:19:11 INFO MemoryStore: Block broadcast_37 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:19:11 INFO MemoryStore: Block broadcast_37_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:19:11 INFO BlockManagerInfo: Added broadcast_37_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:19:11 INFO SparkContext: Created broadcast 37 from broadcast at DAGScheduler.scala:1223
21/01/15 12:19:11 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 37 (MapPartitionsRDD[149] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:19:11 INFO TaskSchedulerImpl: Adding task set 37.0 with 1 tasks
21/01/15 12:19:12 WARN TaskSetManager: Stage 37 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:19:12 INFO TaskSetManager: Starting task 0.0 in stage 37.0 (TID 37, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:19:12 INFO Executor: Running task 0.0 in stage 37.0 (TID 37)
21/01/15 12:19:12 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:12 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:12 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:12 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:12 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:12 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:12 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:19:12 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:19:12 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:19:12 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:19:12 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:19:12 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:19:12 INFO ParquetOutputFormat: Validation is off
21/01/15 12:19:12 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:19:12 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:19:12 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:19:12 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:19:12 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:19:12 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:19:12 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:19:13 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121911_0037_m_000000_37' to o3fs://bucket1.vol1/testdata
21/01/15 12:19:13 INFO SparkHadoopMapRedUtil: attempt_20210115121911_0037_m_000000_37: Committed
21/01/15 12:19:13 INFO Executor: Finished task 0.0 in stage 37.0 (TID 37). 2155 bytes result sent to driver
21/01/15 12:19:13 INFO TaskSetManager: Finished task 0.0 in stage 37.0 (TID 37) in 1149 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:19:13 INFO TaskSchedulerImpl: Removed TaskSet 37.0, whose tasks have all completed, from pool 
21/01/15 12:19:13 INFO DAGScheduler: ResultStage 37 (parquet at Generate.java:61) finished in 1.171 s
21/01/15 12:19:13 INFO DAGScheduler: Job 37 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:19:13 INFO TaskSchedulerImpl: Killing all running tasks in stage 37: Stage finished
21/01/15 12:19:13 INFO DAGScheduler: Job 37 finished: parquet at Generate.java:61, took 1.172386 s
21/01/15 12:19:13 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-74847c68-224b-4d8d-b9d2-384772d12a3d
21/01/15 12:19:13 INFO FileFormatWriter: Write Job 99a6324f-dcfb-4ee8-8caf-6cf826e824d1 committed.
21/01/15 12:19:13 INFO FileFormatWriter: Finished processing stats for write job 99a6324f-dcfb-4ee8-8caf-6cf826e824d1.
21/01/15 12:19:13 INFO BlockManagerInfo: Removed broadcast_37_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:19:14 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:14 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:14 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:14 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:14 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:14 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:14 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:15 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:19:15 INFO DAGScheduler: Got job 38 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:19:15 INFO DAGScheduler: Final stage: ResultStage 38 (parquet at Generate.java:61)
21/01/15 12:19:15 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:19:15 INFO DAGScheduler: Missing parents: List()
21/01/15 12:19:15 INFO DAGScheduler: Submitting ResultStage 38 (MapPartitionsRDD[153] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:19:15 INFO MemoryStore: Block broadcast_38 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:19:15 INFO MemoryStore: Block broadcast_38_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:19:15 INFO BlockManagerInfo: Added broadcast_38_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:19:15 INFO SparkContext: Created broadcast 38 from broadcast at DAGScheduler.scala:1223
21/01/15 12:19:15 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 38 (MapPartitionsRDD[153] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:19:15 INFO TaskSchedulerImpl: Adding task set 38.0 with 1 tasks
21/01/15 12:19:15 WARN TaskSetManager: Stage 38 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:19:15 INFO TaskSetManager: Starting task 0.0 in stage 38.0 (TID 38, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:19:15 INFO Executor: Running task 0.0 in stage 38.0 (TID 38)
21/01/15 12:19:15 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:15 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:15 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:15 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:15 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:15 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:15 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:19:15 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:19:15 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:19:15 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:19:15 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:19:15 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:19:15 INFO ParquetOutputFormat: Validation is off
21/01/15 12:19:15 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:19:15 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:19:15 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:19:15 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:19:15 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:19:15 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:19:15 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:19:16 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121915_0038_m_000000_38' to o3fs://bucket1.vol1/testdata
21/01/15 12:19:16 INFO SparkHadoopMapRedUtil: attempt_20210115121915_0038_m_000000_38: Committed
21/01/15 12:19:16 INFO Executor: Finished task 0.0 in stage 38.0 (TID 38). 2155 bytes result sent to driver
21/01/15 12:19:16 INFO TaskSetManager: Finished task 0.0 in stage 38.0 (TID 38) in 1063 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:19:16 INFO TaskSchedulerImpl: Removed TaskSet 38.0, whose tasks have all completed, from pool 
21/01/15 12:19:16 INFO DAGScheduler: ResultStage 38 (parquet at Generate.java:61) finished in 1.084 s
21/01/15 12:19:16 INFO DAGScheduler: Job 38 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:19:16 INFO TaskSchedulerImpl: Killing all running tasks in stage 38: Stage finished
21/01/15 12:19:16 INFO DAGScheduler: Job 38 finished: parquet at Generate.java:61, took 1.085982 s
21/01/15 12:19:16 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-9246c590-e937-4b17-a558-4eae15d99ee2
21/01/15 12:19:16 INFO FileFormatWriter: Write Job 083d5a9e-ccf0-4157-abd4-6b1dbb6ebbc1 committed.
21/01/15 12:19:16 INFO FileFormatWriter: Finished processing stats for write job 083d5a9e-ccf0-4157-abd4-6b1dbb6ebbc1.
21/01/15 12:19:16 INFO BlockManagerInfo: Removed broadcast_38_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:19:17 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:17 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:17 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:17 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:17 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:17 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:17 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:17 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:19:17 INFO DAGScheduler: Got job 39 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:19:17 INFO DAGScheduler: Final stage: ResultStage 39 (parquet at Generate.java:61)
21/01/15 12:19:17 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:19:17 INFO DAGScheduler: Missing parents: List()
21/01/15 12:19:17 INFO DAGScheduler: Submitting ResultStage 39 (MapPartitionsRDD[157] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:19:18 INFO MemoryStore: Block broadcast_39 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:19:18 INFO MemoryStore: Block broadcast_39_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:19:18 INFO BlockManagerInfo: Added broadcast_39_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:19:18 INFO SparkContext: Created broadcast 39 from broadcast at DAGScheduler.scala:1223
21/01/15 12:19:18 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 39 (MapPartitionsRDD[157] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:19:18 INFO TaskSchedulerImpl: Adding task set 39.0 with 1 tasks
21/01/15 12:19:18 WARN TaskSetManager: Stage 39 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:19:18 INFO TaskSetManager: Starting task 0.0 in stage 39.0 (TID 39, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:19:18 INFO Executor: Running task 0.0 in stage 39.0 (TID 39)
21/01/15 12:19:18 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:18 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:18 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:18 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:18 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:18 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:18 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:19:18 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:19:18 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:19:18 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:19:18 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:19:18 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:19:18 INFO ParquetOutputFormat: Validation is off
21/01/15 12:19:18 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:19:18 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:19:18 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:19:18 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:19:18 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:19:18 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:19:18 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:19:19 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121917_0039_m_000000_39' to o3fs://bucket1.vol1/testdata
21/01/15 12:19:19 INFO SparkHadoopMapRedUtil: attempt_20210115121917_0039_m_000000_39: Committed
21/01/15 12:19:19 INFO Executor: Finished task 0.0 in stage 39.0 (TID 39). 2155 bytes result sent to driver
21/01/15 12:19:19 INFO TaskSetManager: Finished task 0.0 in stage 39.0 (TID 39) in 991 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:19:19 INFO TaskSchedulerImpl: Removed TaskSet 39.0, whose tasks have all completed, from pool 
21/01/15 12:19:19 INFO DAGScheduler: ResultStage 39 (parquet at Generate.java:61) finished in 1.012 s
21/01/15 12:19:19 INFO DAGScheduler: Job 39 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:19:19 INFO TaskSchedulerImpl: Killing all running tasks in stage 39: Stage finished
21/01/15 12:19:19 INFO DAGScheduler: Job 39 finished: parquet at Generate.java:61, took 1.013223 s
21/01/15 12:19:19 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-793512e7-14f9-462e-bea4-a17aa87abfc7
21/01/15 12:19:19 INFO FileFormatWriter: Write Job fcf2f5ad-3904-4efb-abbc-d29f8dd01e85 committed.
21/01/15 12:19:19 INFO FileFormatWriter: Finished processing stats for write job fcf2f5ad-3904-4efb-abbc-d29f8dd01e85.
21/01/15 12:19:19 INFO BlockManagerInfo: Removed broadcast_39_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:19:20 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:20 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:20 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:20 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:20 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:20 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:20 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:20 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:19:20 INFO DAGScheduler: Got job 40 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:19:20 INFO DAGScheduler: Final stage: ResultStage 40 (parquet at Generate.java:61)
21/01/15 12:19:20 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:19:20 INFO DAGScheduler: Missing parents: List()
21/01/15 12:19:20 INFO DAGScheduler: Submitting ResultStage 40 (MapPartitionsRDD[161] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:19:20 INFO MemoryStore: Block broadcast_40 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:19:20 INFO MemoryStore: Block broadcast_40_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:19:20 INFO BlockManagerInfo: Added broadcast_40_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:19:20 INFO SparkContext: Created broadcast 40 from broadcast at DAGScheduler.scala:1223
21/01/15 12:19:20 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 40 (MapPartitionsRDD[161] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:19:20 INFO TaskSchedulerImpl: Adding task set 40.0 with 1 tasks
21/01/15 12:19:21 WARN TaskSetManager: Stage 40 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:19:21 INFO TaskSetManager: Starting task 0.0 in stage 40.0 (TID 40, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:19:21 INFO Executor: Running task 0.0 in stage 40.0 (TID 40)
21/01/15 12:19:21 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:21 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:21 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:21 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:21 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:21 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:21 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:19:21 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:19:21 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:19:21 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:19:21 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:19:21 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:19:21 INFO ParquetOutputFormat: Validation is off
21/01/15 12:19:21 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:19:21 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:19:21 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:19:21 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:19:21 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:19:21 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:19:21 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:19:21 INFO RatisMetrics: Creating Metrics Registry : ratis.client_message_metrics.client-C55EB283940F->b27ffd1c-ee20-4b2d-ad86-0a80e9dc1267
21/01/15 12:19:21 WARN MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReporterRegistration(...) before.
21/01/15 12:19:21 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121920_0040_m_000000_40' to o3fs://bucket1.vol1/testdata
21/01/15 12:19:21 INFO SparkHadoopMapRedUtil: attempt_20210115121920_0040_m_000000_40: Committed
21/01/15 12:19:21 INFO Executor: Finished task 0.0 in stage 40.0 (TID 40). 2155 bytes result sent to driver
21/01/15 12:19:21 INFO TaskSetManager: Finished task 0.0 in stage 40.0 (TID 40) in 1004 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:19:21 INFO TaskSchedulerImpl: Removed TaskSet 40.0, whose tasks have all completed, from pool 
21/01/15 12:19:21 INFO DAGScheduler: ResultStage 40 (parquet at Generate.java:61) finished in 1.024 s
21/01/15 12:19:21 INFO DAGScheduler: Job 40 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:19:21 INFO TaskSchedulerImpl: Killing all running tasks in stage 40: Stage finished
21/01/15 12:19:21 INFO DAGScheduler: Job 40 finished: parquet at Generate.java:61, took 1.026575 s
21/01/15 12:19:21 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-4a646255-db6f-4304-a55b-200a59225d54
21/01/15 12:19:21 INFO FileFormatWriter: Write Job 28659811-dbb1-4c85-b335-4a2d7115b182 committed.
21/01/15 12:19:21 INFO FileFormatWriter: Finished processing stats for write job 28659811-dbb1-4c85-b335-4a2d7115b182.
21/01/15 12:19:22 INFO BlockManagerInfo: Removed broadcast_40_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:19:23 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:23 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:23 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:23 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:23 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:23 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:23 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:23 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:19:23 INFO DAGScheduler: Got job 41 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:19:23 INFO DAGScheduler: Final stage: ResultStage 41 (parquet at Generate.java:61)
21/01/15 12:19:23 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:19:23 INFO DAGScheduler: Missing parents: List()
21/01/15 12:19:23 INFO DAGScheduler: Submitting ResultStage 41 (MapPartitionsRDD[165] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:19:23 INFO MemoryStore: Block broadcast_41 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:19:23 INFO MemoryStore: Block broadcast_41_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:19:23 INFO BlockManagerInfo: Added broadcast_41_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:19:23 INFO SparkContext: Created broadcast 41 from broadcast at DAGScheduler.scala:1223
21/01/15 12:19:23 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 41 (MapPartitionsRDD[165] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:19:23 INFO TaskSchedulerImpl: Adding task set 41.0 with 1 tasks
21/01/15 12:19:23 WARN TaskSetManager: Stage 41 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:19:23 INFO TaskSetManager: Starting task 0.0 in stage 41.0 (TID 41, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:19:23 INFO Executor: Running task 0.0 in stage 41.0 (TID 41)
21/01/15 12:19:23 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:23 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:23 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:23 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:23 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:23 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:23 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:19:23 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:19:23 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:19:23 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:19:23 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:19:23 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:19:23 INFO ParquetOutputFormat: Validation is off
21/01/15 12:19:23 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:19:23 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:19:23 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:19:23 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:19:23 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:19:23 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:19:24 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:19:24 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121923_0041_m_000000_41' to o3fs://bucket1.vol1/testdata
21/01/15 12:19:24 INFO SparkHadoopMapRedUtil: attempt_20210115121923_0041_m_000000_41: Committed
21/01/15 12:19:24 INFO Executor: Finished task 0.0 in stage 41.0 (TID 41). 2155 bytes result sent to driver
21/01/15 12:19:24 INFO TaskSetManager: Finished task 0.0 in stage 41.0 (TID 41) in 987 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:19:24 INFO TaskSchedulerImpl: Removed TaskSet 41.0, whose tasks have all completed, from pool 
21/01/15 12:19:24 INFO DAGScheduler: ResultStage 41 (parquet at Generate.java:61) finished in 1.007 s
21/01/15 12:19:24 INFO DAGScheduler: Job 41 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:19:24 INFO TaskSchedulerImpl: Killing all running tasks in stage 41: Stage finished
21/01/15 12:19:24 INFO DAGScheduler: Job 41 finished: parquet at Generate.java:61, took 1.009992 s
21/01/15 12:19:24 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-fea9f2d5-d337-46a1-94ca-fa136c38d656
21/01/15 12:19:24 INFO FileFormatWriter: Write Job 89476d02-bd53-4b03-9488-3db770c53261 committed.
21/01/15 12:19:24 INFO FileFormatWriter: Finished processing stats for write job 89476d02-bd53-4b03-9488-3db770c53261.
21/01/15 12:19:25 INFO BlockManagerInfo: Removed broadcast_41_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:19:26 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:26 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:26 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:26 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:26 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:26 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:26 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:26 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:19:26 INFO DAGScheduler: Got job 42 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:19:26 INFO DAGScheduler: Final stage: ResultStage 42 (parquet at Generate.java:61)
21/01/15 12:19:26 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:19:26 INFO DAGScheduler: Missing parents: List()
21/01/15 12:19:26 INFO DAGScheduler: Submitting ResultStage 42 (MapPartitionsRDD[169] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:19:26 INFO MemoryStore: Block broadcast_42 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:19:26 INFO MemoryStore: Block broadcast_42_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:19:26 INFO BlockManagerInfo: Added broadcast_42_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:19:26 INFO SparkContext: Created broadcast 42 from broadcast at DAGScheduler.scala:1223
21/01/15 12:19:26 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 42 (MapPartitionsRDD[169] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:19:26 INFO TaskSchedulerImpl: Adding task set 42.0 with 1 tasks
21/01/15 12:19:26 WARN TaskSetManager: Stage 42 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:19:26 INFO TaskSetManager: Starting task 0.0 in stage 42.0 (TID 42, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:19:26 INFO Executor: Running task 0.0 in stage 42.0 (TID 42)
21/01/15 12:19:26 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:26 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:26 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:26 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:26 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:26 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:26 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:19:26 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:19:26 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:19:26 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:19:26 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:19:26 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:19:26 INFO ParquetOutputFormat: Validation is off
21/01/15 12:19:26 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:19:26 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:19:26 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:19:26 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:19:26 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:19:26 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:19:26 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:19:27 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121926_0042_m_000000_42' to o3fs://bucket1.vol1/testdata
21/01/15 12:19:27 INFO SparkHadoopMapRedUtil: attempt_20210115121926_0042_m_000000_42: Committed
21/01/15 12:19:27 INFO Executor: Finished task 0.0 in stage 42.0 (TID 42). 2155 bytes result sent to driver
21/01/15 12:19:27 INFO TaskSetManager: Finished task 0.0 in stage 42.0 (TID 42) in 1068 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:19:27 INFO TaskSchedulerImpl: Removed TaskSet 42.0, whose tasks have all completed, from pool 
21/01/15 12:19:27 INFO DAGScheduler: ResultStage 42 (parquet at Generate.java:61) finished in 1.090 s
21/01/15 12:19:27 INFO DAGScheduler: Job 42 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:19:27 INFO TaskSchedulerImpl: Killing all running tasks in stage 42: Stage finished
21/01/15 12:19:27 INFO DAGScheduler: Job 42 finished: parquet at Generate.java:61, took 1.092507 s
21/01/15 12:19:27 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-be2eb914-c27d-48fe-ae48-bf346f89b48b
21/01/15 12:19:27 INFO FileFormatWriter: Write Job a81d3483-a5af-460b-9744-068909b26888 committed.
21/01/15 12:19:27 INFO FileFormatWriter: Finished processing stats for write job a81d3483-a5af-460b-9744-068909b26888.
21/01/15 12:19:28 INFO BlockManagerInfo: Removed broadcast_42_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:19:29 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:29 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:29 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:29 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:29 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:29 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:29 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:29 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:19:29 INFO DAGScheduler: Got job 43 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:19:29 INFO DAGScheduler: Final stage: ResultStage 43 (parquet at Generate.java:61)
21/01/15 12:19:29 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:19:29 INFO DAGScheduler: Missing parents: List()
21/01/15 12:19:29 INFO DAGScheduler: Submitting ResultStage 43 (MapPartitionsRDD[173] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:19:29 INFO MemoryStore: Block broadcast_43 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:19:29 INFO MemoryStore: Block broadcast_43_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:19:29 INFO BlockManagerInfo: Added broadcast_43_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:19:29 INFO SparkContext: Created broadcast 43 from broadcast at DAGScheduler.scala:1223
21/01/15 12:19:29 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 43 (MapPartitionsRDD[173] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:19:29 INFO TaskSchedulerImpl: Adding task set 43.0 with 1 tasks
21/01/15 12:19:29 WARN TaskSetManager: Stage 43 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:19:29 INFO TaskSetManager: Starting task 0.0 in stage 43.0 (TID 43, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:19:29 INFO Executor: Running task 0.0 in stage 43.0 (TID 43)
21/01/15 12:19:29 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:29 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:29 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:29 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:29 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:29 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:29 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:19:29 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:19:29 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:19:29 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:19:29 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:19:29 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:19:29 INFO ParquetOutputFormat: Validation is off
21/01/15 12:19:29 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:19:29 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:19:29 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:19:29 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:19:29 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:19:29 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:19:29 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:19:30 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121929_0043_m_000000_43' to o3fs://bucket1.vol1/testdata
21/01/15 12:19:30 INFO SparkHadoopMapRedUtil: attempt_20210115121929_0043_m_000000_43: Committed
21/01/15 12:19:30 INFO Executor: Finished task 0.0 in stage 43.0 (TID 43). 2155 bytes result sent to driver
21/01/15 12:19:30 INFO TaskSetManager: Finished task 0.0 in stage 43.0 (TID 43) in 973 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:19:30 INFO TaskSchedulerImpl: Removed TaskSet 43.0, whose tasks have all completed, from pool 
21/01/15 12:19:30 INFO DAGScheduler: ResultStage 43 (parquet at Generate.java:61) finished in 0.995 s
21/01/15 12:19:30 INFO DAGScheduler: Job 43 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:19:30 INFO TaskSchedulerImpl: Killing all running tasks in stage 43: Stage finished
21/01/15 12:19:30 INFO DAGScheduler: Job 43 finished: parquet at Generate.java:61, took 0.996183 s
21/01/15 12:19:30 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-7986de66-a1bb-411a-b681-98a24d4881d1
21/01/15 12:19:30 INFO FileFormatWriter: Write Job 2bab3db3-8438-48e8-9db3-34b8d3164d4d committed.
21/01/15 12:19:30 INFO FileFormatWriter: Finished processing stats for write job 2bab3db3-8438-48e8-9db3-34b8d3164d4d.
21/01/15 12:19:31 INFO BlockManagerInfo: Removed broadcast_43_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:19:32 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:32 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:32 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:32 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:32 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:32 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:32 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:32 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:19:32 INFO DAGScheduler: Got job 44 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:19:32 INFO DAGScheduler: Final stage: ResultStage 44 (parquet at Generate.java:61)
21/01/15 12:19:32 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:19:32 INFO DAGScheduler: Missing parents: List()
21/01/15 12:19:32 INFO DAGScheduler: Submitting ResultStage 44 (MapPartitionsRDD[177] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:19:32 INFO MemoryStore: Block broadcast_44 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:19:32 INFO MemoryStore: Block broadcast_44_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:19:32 INFO BlockManagerInfo: Added broadcast_44_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:19:32 INFO SparkContext: Created broadcast 44 from broadcast at DAGScheduler.scala:1223
21/01/15 12:19:32 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 44 (MapPartitionsRDD[177] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:19:32 INFO TaskSchedulerImpl: Adding task set 44.0 with 1 tasks
21/01/15 12:19:32 WARN TaskSetManager: Stage 44 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:19:32 INFO TaskSetManager: Starting task 0.0 in stage 44.0 (TID 44, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:19:32 INFO Executor: Running task 0.0 in stage 44.0 (TID 44)
21/01/15 12:19:32 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:32 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:32 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:32 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:32 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:32 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:32 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:19:32 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:19:32 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:19:32 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:19:32 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:19:32 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:19:32 INFO ParquetOutputFormat: Validation is off
21/01/15 12:19:32 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:19:32 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:19:32 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:19:32 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:19:32 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:19:32 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:19:32 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:19:33 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121932_0044_m_000000_44' to o3fs://bucket1.vol1/testdata
21/01/15 12:19:33 INFO SparkHadoopMapRedUtil: attempt_20210115121932_0044_m_000000_44: Committed
21/01/15 12:19:33 INFO Executor: Finished task 0.0 in stage 44.0 (TID 44). 2155 bytes result sent to driver
21/01/15 12:19:33 INFO TaskSetManager: Finished task 0.0 in stage 44.0 (TID 44) in 969 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:19:33 INFO TaskSchedulerImpl: Removed TaskSet 44.0, whose tasks have all completed, from pool 
21/01/15 12:19:33 INFO DAGScheduler: ResultStage 44 (parquet at Generate.java:61) finished in 0.989 s
21/01/15 12:19:33 INFO DAGScheduler: Job 44 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:19:33 INFO TaskSchedulerImpl: Killing all running tasks in stage 44: Stage finished
21/01/15 12:19:33 INFO DAGScheduler: Job 44 finished: parquet at Generate.java:61, took 0.991487 s
21/01/15 12:19:33 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-23edf9a2-00e0-4edd-9359-4cbe51e423d0
21/01/15 12:19:33 INFO FileFormatWriter: Write Job 55f9c026-870a-4564-9ec6-740f5c5cef5c committed.
21/01/15 12:19:33 INFO FileFormatWriter: Finished processing stats for write job 55f9c026-870a-4564-9ec6-740f5c5cef5c.
21/01/15 12:19:33 INFO BlockManagerInfo: Removed broadcast_44_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:19:35 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:35 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:35 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:35 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:35 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:35 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:35 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:35 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:19:35 INFO DAGScheduler: Got job 45 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:19:35 INFO DAGScheduler: Final stage: ResultStage 45 (parquet at Generate.java:61)
21/01/15 12:19:35 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:19:35 INFO DAGScheduler: Missing parents: List()
21/01/15 12:19:35 INFO DAGScheduler: Submitting ResultStage 45 (MapPartitionsRDD[181] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:19:35 INFO MemoryStore: Block broadcast_45 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:19:35 INFO MemoryStore: Block broadcast_45_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:19:35 INFO BlockManagerInfo: Added broadcast_45_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:19:35 INFO SparkContext: Created broadcast 45 from broadcast at DAGScheduler.scala:1223
21/01/15 12:19:35 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 45 (MapPartitionsRDD[181] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:19:35 INFO TaskSchedulerImpl: Adding task set 45.0 with 1 tasks
21/01/15 12:19:35 WARN TaskSetManager: Stage 45 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:19:35 INFO TaskSetManager: Starting task 0.0 in stage 45.0 (TID 45, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:19:35 INFO Executor: Running task 0.0 in stage 45.0 (TID 45)
21/01/15 12:19:35 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:35 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:35 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:35 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:35 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:35 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:35 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:19:35 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:19:35 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:19:35 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:19:35 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:19:35 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:19:35 INFO ParquetOutputFormat: Validation is off
21/01/15 12:19:35 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:19:35 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:19:35 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:19:35 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:19:35 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:19:35 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:19:35 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:19:36 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121935_0045_m_000000_45' to o3fs://bucket1.vol1/testdata
21/01/15 12:19:36 INFO SparkHadoopMapRedUtil: attempt_20210115121935_0045_m_000000_45: Committed
21/01/15 12:19:36 INFO Executor: Finished task 0.0 in stage 45.0 (TID 45). 2155 bytes result sent to driver
21/01/15 12:19:36 INFO TaskSetManager: Finished task 0.0 in stage 45.0 (TID 45) in 978 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:19:36 INFO TaskSchedulerImpl: Removed TaskSet 45.0, whose tasks have all completed, from pool 
21/01/15 12:19:36 INFO DAGScheduler: ResultStage 45 (parquet at Generate.java:61) finished in 1.000 s
21/01/15 12:19:36 INFO DAGScheduler: Job 45 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:19:36 INFO TaskSchedulerImpl: Killing all running tasks in stage 45: Stage finished
21/01/15 12:19:36 INFO DAGScheduler: Job 45 finished: parquet at Generate.java:61, took 1.002268 s
21/01/15 12:19:36 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-c71dd9bf-c511-48f3-9c1f-d971bd9c686e
21/01/15 12:19:36 INFO FileFormatWriter: Write Job 84f79c7f-fe80-48ae-934d-6b2045e94c90 committed.
21/01/15 12:19:36 INFO FileFormatWriter: Finished processing stats for write job 84f79c7f-fe80-48ae-934d-6b2045e94c90.
21/01/15 12:19:36 INFO BlockManagerInfo: Removed broadcast_45_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:19:38 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:38 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:38 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:38 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:38 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:38 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:38 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:38 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:19:38 INFO DAGScheduler: Got job 46 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:19:38 INFO DAGScheduler: Final stage: ResultStage 46 (parquet at Generate.java:61)
21/01/15 12:19:38 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:19:38 INFO DAGScheduler: Missing parents: List()
21/01/15 12:19:38 INFO DAGScheduler: Submitting ResultStage 46 (MapPartitionsRDD[185] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:19:38 INFO MemoryStore: Block broadcast_46 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:19:38 INFO MemoryStore: Block broadcast_46_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:19:38 INFO BlockManagerInfo: Added broadcast_46_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:19:38 INFO SparkContext: Created broadcast 46 from broadcast at DAGScheduler.scala:1223
21/01/15 12:19:38 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 46 (MapPartitionsRDD[185] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:19:38 INFO TaskSchedulerImpl: Adding task set 46.0 with 1 tasks
21/01/15 12:19:38 WARN TaskSetManager: Stage 46 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:19:38 INFO TaskSetManager: Starting task 0.0 in stage 46.0 (TID 46, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:19:38 INFO Executor: Running task 0.0 in stage 46.0 (TID 46)
21/01/15 12:19:38 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:38 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:38 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:38 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:38 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:38 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:38 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:19:38 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:19:38 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:19:38 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:19:38 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:19:38 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:19:38 INFO ParquetOutputFormat: Validation is off
21/01/15 12:19:38 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:19:38 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:19:38 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:19:38 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:19:38 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:19:38 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:19:38 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:19:39 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121938_0046_m_000000_46' to o3fs://bucket1.vol1/testdata
21/01/15 12:19:39 INFO SparkHadoopMapRedUtil: attempt_20210115121938_0046_m_000000_46: Committed
21/01/15 12:19:39 INFO Executor: Finished task 0.0 in stage 46.0 (TID 46). 2155 bytes result sent to driver
21/01/15 12:19:39 INFO TaskSetManager: Finished task 0.0 in stage 46.0 (TID 46) in 1040 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:19:39 INFO TaskSchedulerImpl: Removed TaskSet 46.0, whose tasks have all completed, from pool 
21/01/15 12:19:39 INFO DAGScheduler: ResultStage 46 (parquet at Generate.java:61) finished in 1.063 s
21/01/15 12:19:39 INFO DAGScheduler: Job 46 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:19:39 INFO TaskSchedulerImpl: Killing all running tasks in stage 46: Stage finished
21/01/15 12:19:39 INFO DAGScheduler: Job 46 finished: parquet at Generate.java:61, took 1.064341 s
21/01/15 12:19:39 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-f9e18f36-cead-4308-8ab5-dd17b208d0a0
21/01/15 12:19:39 INFO FileFormatWriter: Write Job 754306c8-5673-4995-b582-c1098089a2cb committed.
21/01/15 12:19:39 INFO FileFormatWriter: Finished processing stats for write job 754306c8-5673-4995-b582-c1098089a2cb.
21/01/15 12:19:39 INFO BlockManagerInfo: Removed broadcast_46_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:19:41 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:41 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:41 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:41 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:41 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:41 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:41 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:41 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:19:41 INFO DAGScheduler: Got job 47 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:19:41 INFO DAGScheduler: Final stage: ResultStage 47 (parquet at Generate.java:61)
21/01/15 12:19:41 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:19:41 INFO DAGScheduler: Missing parents: List()
21/01/15 12:19:41 INFO DAGScheduler: Submitting ResultStage 47 (MapPartitionsRDD[189] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:19:41 INFO MemoryStore: Block broadcast_47 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:19:41 INFO MemoryStore: Block broadcast_47_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:19:41 INFO BlockManagerInfo: Added broadcast_47_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:19:41 INFO SparkContext: Created broadcast 47 from broadcast at DAGScheduler.scala:1223
21/01/15 12:19:41 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 47 (MapPartitionsRDD[189] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:19:41 INFO TaskSchedulerImpl: Adding task set 47.0 with 1 tasks
21/01/15 12:19:41 WARN TaskSetManager: Stage 47 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:19:41 INFO TaskSetManager: Starting task 0.0 in stage 47.0 (TID 47, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:19:41 INFO Executor: Running task 0.0 in stage 47.0 (TID 47)
21/01/15 12:19:41 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:41 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:41 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:41 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:41 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:41 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:41 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:19:41 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:19:41 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:19:41 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:19:41 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:19:41 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:19:41 INFO ParquetOutputFormat: Validation is off
21/01/15 12:19:41 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:19:41 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:19:41 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:19:41 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:19:41 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:19:41 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:19:41 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:19:42 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121941_0047_m_000000_47' to o3fs://bucket1.vol1/testdata
21/01/15 12:19:42 INFO SparkHadoopMapRedUtil: attempt_20210115121941_0047_m_000000_47: Committed
21/01/15 12:19:42 INFO Executor: Finished task 0.0 in stage 47.0 (TID 47). 2155 bytes result sent to driver
21/01/15 12:19:42 INFO TaskSetManager: Finished task 0.0 in stage 47.0 (TID 47) in 857 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:19:42 INFO TaskSchedulerImpl: Removed TaskSet 47.0, whose tasks have all completed, from pool 
21/01/15 12:19:42 INFO DAGScheduler: ResultStage 47 (parquet at Generate.java:61) finished in 0.877 s
21/01/15 12:19:42 INFO DAGScheduler: Job 47 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:19:42 INFO TaskSchedulerImpl: Killing all running tasks in stage 47: Stage finished
21/01/15 12:19:42 INFO DAGScheduler: Job 47 finished: parquet at Generate.java:61, took 0.881839 s
21/01/15 12:19:42 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-a68e40eb-9211-422d-b6a2-c2e659821c87
21/01/15 12:19:42 INFO FileFormatWriter: Write Job 847c73bc-b515-46c2-a95f-13ff0f78db45 committed.
21/01/15 12:19:42 INFO FileFormatWriter: Finished processing stats for write job 847c73bc-b515-46c2-a95f-13ff0f78db45.
21/01/15 12:19:42 INFO BlockManagerInfo: Removed broadcast_47_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:19:43 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:43 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:43 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:43 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:43 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:43 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:43 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:43 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:19:43 INFO DAGScheduler: Got job 48 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:19:43 INFO DAGScheduler: Final stage: ResultStage 48 (parquet at Generate.java:61)
21/01/15 12:19:43 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:19:43 INFO DAGScheduler: Missing parents: List()
21/01/15 12:19:43 INFO DAGScheduler: Submitting ResultStage 48 (MapPartitionsRDD[193] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:19:43 INFO MemoryStore: Block broadcast_48 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:19:43 INFO MemoryStore: Block broadcast_48_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:19:43 INFO BlockManagerInfo: Added broadcast_48_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:19:43 INFO SparkContext: Created broadcast 48 from broadcast at DAGScheduler.scala:1223
21/01/15 12:19:44 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 48 (MapPartitionsRDD[193] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:19:44 INFO TaskSchedulerImpl: Adding task set 48.0 with 1 tasks
21/01/15 12:19:44 WARN TaskSetManager: Stage 48 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:19:44 INFO TaskSetManager: Starting task 0.0 in stage 48.0 (TID 48, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:19:44 INFO Executor: Running task 0.0 in stage 48.0 (TID 48)
21/01/15 12:19:44 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:44 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:44 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:44 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:44 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:44 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:44 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:19:44 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:19:44 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:19:44 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:19:44 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:19:44 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:19:44 INFO ParquetOutputFormat: Validation is off
21/01/15 12:19:44 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:19:44 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:19:44 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:19:44 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:19:44 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:19:44 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:19:44 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:19:44 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121943_0048_m_000000_48' to o3fs://bucket1.vol1/testdata
21/01/15 12:19:44 INFO SparkHadoopMapRedUtil: attempt_20210115121943_0048_m_000000_48: Committed
21/01/15 12:19:44 INFO Executor: Finished task 0.0 in stage 48.0 (TID 48). 2155 bytes result sent to driver
21/01/15 12:19:44 INFO TaskSetManager: Finished task 0.0 in stage 48.0 (TID 48) in 953 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:19:44 INFO TaskSchedulerImpl: Removed TaskSet 48.0, whose tasks have all completed, from pool 
21/01/15 12:19:44 INFO DAGScheduler: ResultStage 48 (parquet at Generate.java:61) finished in 0.973 s
21/01/15 12:19:44 INFO DAGScheduler: Job 48 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:19:44 INFO TaskSchedulerImpl: Killing all running tasks in stage 48: Stage finished
21/01/15 12:19:44 INFO DAGScheduler: Job 48 finished: parquet at Generate.java:61, took 0.975292 s
21/01/15 12:19:44 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-116f1410-e447-491a-8106-e91834e64b86
21/01/15 12:19:44 INFO FileFormatWriter: Write Job 87674aac-caee-4bbf-8424-da3957faa22c committed.
21/01/15 12:19:44 INFO FileFormatWriter: Finished processing stats for write job 87674aac-caee-4bbf-8424-da3957faa22c.
21/01/15 12:19:45 INFO BlockManagerInfo: Removed broadcast_48_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:19:46 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:46 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:46 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:46 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:46 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:46 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:46 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:46 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:19:46 INFO DAGScheduler: Got job 49 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:19:46 INFO DAGScheduler: Final stage: ResultStage 49 (parquet at Generate.java:61)
21/01/15 12:19:46 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:19:46 INFO DAGScheduler: Missing parents: List()
21/01/15 12:19:46 INFO DAGScheduler: Submitting ResultStage 49 (MapPartitionsRDD[197] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:19:46 INFO MemoryStore: Block broadcast_49 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:19:46 INFO MemoryStore: Block broadcast_49_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:19:46 INFO BlockManagerInfo: Added broadcast_49_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:19:46 INFO SparkContext: Created broadcast 49 from broadcast at DAGScheduler.scala:1223
21/01/15 12:19:46 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 49 (MapPartitionsRDD[197] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:19:46 INFO TaskSchedulerImpl: Adding task set 49.0 with 1 tasks
21/01/15 12:19:46 WARN TaskSetManager: Stage 49 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:19:46 INFO TaskSetManager: Starting task 0.0 in stage 49.0 (TID 49, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:19:46 INFO Executor: Running task 0.0 in stage 49.0 (TID 49)
21/01/15 12:19:46 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:46 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:46 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:46 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:46 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:46 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:46 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:19:46 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:19:46 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:19:46 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:19:46 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:19:46 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:19:46 INFO ParquetOutputFormat: Validation is off
21/01/15 12:19:46 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:19:46 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:19:46 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:19:46 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:19:46 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:19:46 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:19:47 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:19:48 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121946_0049_m_000000_49' to o3fs://bucket1.vol1/testdata
21/01/15 12:19:48 INFO SparkHadoopMapRedUtil: attempt_20210115121946_0049_m_000000_49: Committed
21/01/15 12:19:48 INFO Executor: Finished task 0.0 in stage 49.0 (TID 49). 2155 bytes result sent to driver
21/01/15 12:19:48 INFO TaskSetManager: Finished task 0.0 in stage 49.0 (TID 49) in 1234 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:19:48 INFO TaskSchedulerImpl: Removed TaskSet 49.0, whose tasks have all completed, from pool 
21/01/15 12:19:48 INFO DAGScheduler: ResultStage 49 (parquet at Generate.java:61) finished in 1.255 s
21/01/15 12:19:48 INFO DAGScheduler: Job 49 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:19:48 INFO TaskSchedulerImpl: Killing all running tasks in stage 49: Stage finished
21/01/15 12:19:48 INFO DAGScheduler: Job 49 finished: parquet at Generate.java:61, took 1.256889 s
21/01/15 12:19:48 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-2a09da3f-a9c6-43b2-b7f7-a9fe1aab9684
21/01/15 12:19:48 INFO FileFormatWriter: Write Job bb518d4c-e56e-4d0a-bded-32093d9f3547 committed.
21/01/15 12:19:48 INFO FileFormatWriter: Finished processing stats for write job bb518d4c-e56e-4d0a-bded-32093d9f3547.
21/01/15 12:19:48 INFO BlockManagerInfo: Removed broadcast_49_piece0 on test-runner-nc6ld:33443 in memory (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:19:49 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:49 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:49 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:49 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:49 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:49 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:49 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:49 INFO SparkContext: Starting job: parquet at Generate.java:61
21/01/15 12:19:49 INFO DAGScheduler: Got job 50 (parquet at Generate.java:61) with 1 output partitions
21/01/15 12:19:49 INFO DAGScheduler: Final stage: ResultStage 50 (parquet at Generate.java:61)
21/01/15 12:19:49 INFO DAGScheduler: Parents of final stage: List()
21/01/15 12:19:49 INFO DAGScheduler: Missing parents: List()
21/01/15 12:19:49 INFO DAGScheduler: Submitting ResultStage 50 (MapPartitionsRDD[201] at parquet at Generate.java:61), which has no missing parents
21/01/15 12:19:49 INFO MemoryStore: Block broadcast_50 stored as values in memory (estimated size 205.9 KiB, free 413.7 MiB)
21/01/15 12:19:49 INFO MemoryStore: Block broadcast_50_piece0 stored as bytes in memory (estimated size 73.4 KiB, free 413.7 MiB)
21/01/15 12:19:49 INFO BlockManagerInfo: Added broadcast_50_piece0 in memory on test-runner-nc6ld:33443 (size: 73.4 KiB, free: 413.9 MiB)
21/01/15 12:19:49 INFO SparkContext: Created broadcast 50 from broadcast at DAGScheduler.scala:1223
21/01/15 12:19:49 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 50 (MapPartitionsRDD[201] at parquet at Generate.java:61) (first 15 tasks are for partitions Vector(0))
21/01/15 12:19:49 INFO TaskSchedulerImpl: Adding task set 50.0 with 1 tasks
21/01/15 12:19:50 WARN TaskSetManager: Stage 50 contains a task of very large size (102911 KiB). The maximum recommended task size is 1000 KiB.
21/01/15 12:19:50 INFO TaskSetManager: Starting task 0.0 in stage 50.0 (TID 50, test-runner-nc6ld, executor driver, partition 0, PROCESS_LOCAL, 105381192 bytes)
21/01/15 12:19:50 INFO Executor: Running task 0.0 in stage 50.0 (TID 50)
21/01/15 12:19:50 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:50 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:50 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:50 INFO FileOutputCommitter: File Output Committer Algorithm version is 2
21/01/15 12:19:50 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
21/01/15 12:19:50 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/15 12:19:50 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:19:50 INFO CodecConfig: Compression: SNAPPY
21/01/15 12:19:50 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/15 12:19:50 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/15 12:19:50 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/15 12:19:50 INFO ParquetOutputFormat: Dictionary is on
21/01/15 12:19:50 INFO ParquetOutputFormat: Validation is off
21/01/15 12:19:50 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/15 12:19:50 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/15 12:19:50 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/15 12:19:50 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/15 12:19:50 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/15 12:19:50 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "data",
    "type" : "binary",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "index",
    "type" : "integer",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary data;
  required int32 index;
}

       
21/01/15 12:19:50 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 104858404
21/01/15 12:19:51 INFO FileOutputCommitter: Saved output of task 'attempt_20210115121949_0050_m_000000_50' to o3fs://bucket1.vol1/testdata
21/01/15 12:19:51 INFO SparkHadoopMapRedUtil: attempt_20210115121949_0050_m_000000_50: Committed
21/01/15 12:19:51 INFO Executor: Finished task 0.0 in stage 50.0 (TID 50). 2155 bytes result sent to driver
21/01/15 12:19:51 INFO TaskSetManager: Finished task 0.0 in stage 50.0 (TID 50) in 1250 ms on test-runner-nc6ld (executor driver) (1/1)
21/01/15 12:19:51 INFO TaskSchedulerImpl: Removed TaskSet 50.0, whose tasks have all completed, from pool 
21/01/15 12:19:51 INFO DAGScheduler: ResultStage 50 (parquet at Generate.java:61) finished in 1.270 s
21/01/15 12:19:51 INFO DAGScheduler: Job 50 is finished. Cancelling potential speculative or zombie tasks for this job
21/01/15 12:19:51 INFO TaskSchedulerImpl: Killing all running tasks in stage 50: Stage finished
21/01/15 12:19:51 INFO DAGScheduler: Job 50 finished: parquet at Generate.java:61, took 1.272393 s
21/01/15 12:19:51 WARN BasicOzoneFileSystem: delete: Path does not exist: o3fs://bucket1.vol1/testdata/.spark-staging-373f9a8e-7e2b-47ce-9733-5076927f3966
21/01/15 12:19:51 INFO FileFormatWriter: Write Job f7675a51-7e77-4ada-9d21-6f964ac7bc2d committed.
21/01/15 12:19:51 INFO FileFormatWriter: Finished processing stats for write job f7675a51-7e77-4ada-9d21-6f964ac7bc2d.
21/01/15 12:19:51 INFO SparkUI: Stopped Spark web UI at http://test-runner-nc6ld:4040
21/01/15 12:19:51 INFO MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!
21/01/15 12:19:51 INFO MemoryStore: MemoryStore cleared
21/01/15 12:19:51 INFO BlockManager: BlockManager stopped
21/01/15 12:19:51 INFO BlockManagerMaster: BlockManagerMaster stopped
21/01/15 12:19:51 INFO OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!
21/01/15 12:19:51 INFO SparkContext: Successfully stopped SparkContext
21/01/15 12:19:51 INFO ShutdownHookManager: Shutdown hook called
21/01/15 12:19:51 INFO ShutdownHookManager: Deleting directory /tmp/spark-c039fb37-0325-4999-9c88-2a838a885c83
21/01/15 12:19:51 INFO ShutdownHookManager: Deleting directory /tmp/spark-b02299ef-ab4d-4365-9e8e-d32c6efeea72

real	2m42.252s
user	2m47.609s
sys	0m5.478s
Process exited with exit code 0
