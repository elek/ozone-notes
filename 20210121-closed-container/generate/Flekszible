source:
  - url: git::https://github.com/flokkr/docker-ozone.git
import:
    - path: ozone
transformations:
  - type: ozone/image
    image: ghcr.io/elek/ozone-dev:3f25e0143
  - type: PublishService
  - type: placement
  - type: hostpath
    path: /data
  - type: dataconfig
  - type: add
    trigger:
      metadata:
        name: ozone-config
    path:
      - data
    value:
      HADOOP_OPTS: -XX:ParallelGCThreads=8
  - type: add
    trigger:
      metadata:
        name: ozone-config
    path:
     - data
    value:
      SLEEP_AFTER_SECONDS: infinity
  - type: remove
    path:
      - spec
      - template
      - spec
      - initContainers
  - type: replace
    trigger:
      metadata:
        name: ozone-scm
    path:
      - spec
      - template
      - spec
      - containers
      - .*
      - args
    value:
      - ozone
      - freon
      - cgscm
      - -n
      - "200"
  - type: replace
    trigger:
      metadata:
        name: ozone-om
    path:
      - spec
      - template
      - spec
      - containers
      - .*
      - args
    value:
      - ozone
      - freon
      - cgom
      - -n
      - "200"
  - type: replace
    trigger:
      metadata:
        name: ozone-datanode
    path:
      - spec
      - template
      - spec
      - containers
      - .*
      - args
    value:
      - ozone
      - freon
      - cgdn
      - -n
      - "200"
      - -t
      - "48"